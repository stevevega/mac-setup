{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/Phone/Relay/Nexmo.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"Phone\\Relay","location":[11,0,11,22]},{"kind":1,"name":"Client","modifiers":4096,"location":[13,5,13,23],"associated":[{"kind":1,"name":"Guzzle\\Http\\Client"}]},{"kind":1,"name":"Error","modifiers":4096,"location":[14,5,14,15],"associated":[{"kind":1,"name":"Kima\\Error"}]},{"kind":1,"name":"L10n","modifiers":4096,"location":[15,5,15,14],"associated":[{"kind":1,"name":"Kima\\L10n"}]},{"kind":1,"name":"App","modifiers":4096,"location":[16,5,16,19],"associated":[{"kind":1,"name":"Kima\\Prime\\App"}]},{"kind":1,"name":"IRelay","modifiers":4096,"location":[17,5,17,17],"associated":[{"kind":1,"name":"Phone\\IRelay"}]},{"kind":1,"name":"Phone\\Relay\\Nexmo","location":[34,0,429,1],"associated":[{"kind":2,"name":"Phone\\IRelay"}],"description":"Phone relay service.\n\nIMPORTANT: if you want to use this service for more frequest SMS sending,\nplease read this article:\nhttps://help.nexmo.com/hc/en-us/articles/203993598-What-is-the-Throughput-Limit-for-Outbound-SMS-\nAnd make sure to implement a queue in order to throttle messages.\n\nMessages mark as rejected but sent will be charged by this provider\nThis have to be taken into consideration when the SMS notification will be charged to the doctor\n\nFor the current use, phone verification, 30 sms per second is enough.","children":[{"kind":1024,"name":"ERROR_CONNECTION_FAIL","modifiers":1,"location":[39,10,39,93],"scope":"Phone\\Relay\\Nexmo","value":"'[curl] 6: Could not resolve host: rest.nexmo.com [url] %s'"},{"kind":1024,"name":"API_KEY","modifiers":1,"location":[41,10,41,30],"scope":"Phone\\Relay\\Nexmo","value":"'e2f0519a'"},{"kind":1024,"name":"API_SECRET","modifiers":1,"location":[42,10,42,41],"scope":"Phone\\Relay\\Nexmo","value":"'57422d77b4b2f0a5'"},{"kind":1024,"name":"PROVIDER_NAME","modifiers":1,"location":[47,10,47,33],"scope":"Phone\\Relay\\Nexmo","value":"'Nexmo'"},{"kind":1024,"name":"SMS","modifiers":1,"location":[52,10,52,17],"scope":"Phone\\Relay\\Nexmo","value":"1"},{"kind":1024,"name":"TTS","modifiers":1,"location":[53,10,53,17],"scope":"Phone\\Relay\\Nexmo","value":"0"},{"kind":1024,"name":"SMS_EP","modifiers":1,"location":[58,10,58,52],"scope":"Phone\\Relay\\Nexmo","value":"'https://rest.nexmo.com/sms/json'"},{"kind":1024,"name":"TTS_EP","modifiers":1,"location":[59,10,59,51],"scope":"Phone\\Relay\\Nexmo","value":"'https://api.nexmo.com/tts/json'"},{"kind":1024,"name":"LANGS","modifiers":1,"location":[61,10,64,5],"scope":"Phone\\Relay\\Nexmo","value":"[\n        'en' => 'en-us',\n        'es' => 'es-us'\n    ]"},{"kind":1024,"name":"SUCCESS","modifiers":1,"location":[69,10,69,21],"scope":"Phone\\Relay\\Nexmo","value":"0"},{"kind":1024,"name":"THROTTLED","modifiers":1,"location":[70,10,70,23],"scope":"Phone\\Relay\\Nexmo","value":"1"},{"kind":1024,"name":"INTERNAL_ERROR","modifiers":1,"location":[71,10,71,28],"scope":"Phone\\Relay\\Nexmo","value":"5"},{"kind":1024,"name":"COMUNICATION_FAILED","modifiers":1,"location":[72,10,72,34],"scope":"Phone\\Relay\\Nexmo","value":"13"},{"kind":1024,"name":"STATUS_TO_RETRY","modifiers":1,"location":[77,10,81,5],"scope":"Phone\\Relay\\Nexmo","value":"[\n        self::THROTTLED,\n        self::INTERNAL_ERROR,\n        self::COMUNICATION_FAILED\n    ]"},{"kind":16,"name":"$price","modifiers":4,"location":[88,12,88,22],"scope":"Phone\\Relay\\Nexmo","type":"float"},{"kind":16,"name":"$count","modifiers":4,"location":[95,12,95,22],"scope":"Phone\\Relay\\Nexmo","type":"int"},{"kind":16,"name":"$error_text","modifiers":4,"location":[102,12,102,28],"scope":"Phone\\Relay\\Nexmo","type":"string"},{"kind":16,"name":"$id_msg","modifiers":4,"location":[107,12,107,24],"scope":"Phone\\Relay\\Nexmo"},{"kind":16,"name":"$status","modifiers":4,"location":[114,12,114,19],"scope":"Phone\\Relay\\Nexmo","type":"int"},{"kind":16,"name":"$script_controller","modifiers":4,"location":[121,12,121,30],"scope":"Phone\\Relay\\Nexmo","type":"object"},{"kind":32,"name":"send_sms","modifiers":1,"location":[131,4,140,5],"scope":"Phone\\Relay\\Nexmo","type":"int","children":[{"kind":128,"name":"$phone_number","location":[131,29,131,42],"scope":"send_sms","type":"int"},{"kind":128,"name":"$message","location":[131,44,131,52],"scope":"send_sms","type":"string"}]},{"kind":32,"name":"make_phone_call","modifiers":1,"location":[150,4,166,5],"scope":"Phone\\Relay\\Nexmo","type":"int","children":[{"kind":128,"name":"$phone_number","location":[150,36,150,49],"scope":"make_phone_call","type":"int"},{"kind":128,"name":"$pin","location":[150,51,150,55],"scope":"make_phone_call","type":"int"}]},{"kind":32,"name":"get_price","modifiers":1,"location":[174,4,177,5],"description":"Get the price by executing the operation(dollars)\nThis must be the sum of the calls to the provider Ejm sum all the sent sms","scope":"Phone\\Relay\\Nexmo","type":"float"},{"kind":32,"name":"get_count","modifiers":1,"location":[185,4,188,5],"description":"Get the amount of calls to the provider to executed the action\nEjm Number of SMS send or call made","scope":"Phone\\Relay\\Nexmo","type":"int"},{"kind":32,"name":"get_error_text","modifiers":1,"location":[195,4,198,5],"description":"Get the error text in case to exist any","scope":"Phone\\Relay\\Nexmo","type":"string"},{"kind":32,"name":"get_status","modifiers":1,"location":[205,4,208,5],"description":"Get the status of the request","scope":"Phone\\Relay\\Nexmo","type":"string"},{"kind":32,"name":"get_id_msg","modifiers":1,"location":[215,4,218,5],"description":"Get the id of the sent object","scope":"Phone\\Relay\\Nexmo","type":"string"},{"kind":32,"name":"get_provider_name","modifiers":1,"location":[225,4,228,5],"description":"Get the name of the sms provider","scope":"Phone\\Relay\\Nexmo","type":"string"},{"kind":32,"name":"has_to_retry","modifiers":1,"location":[235,4,238,5],"description":"This function indicates when on failure the sms messages have to try to resend","scope":"Phone\\Relay\\Nexmo","type":"bool"},{"kind":32,"name":"set_script_controller","modifiers":1,"location":[245,4,250,5],"description":"Set the script output controller","scope":"Phone\\Relay\\Nexmo","children":[{"kind":128,"name":"$script_controller","location":[245,42,245,60],"scope":"set_script_controller","type":"object"}]},{"kind":32,"name":"make_api_call","modifiers":4,"location":[261,4,292,5],"description":"Will make an curl POST request using Guzzle to the Nexmo API endpoints.","scope":"Phone\\Relay\\Nexmo","type":"int","children":[{"kind":128,"name":"$params","location":[261,35,261,48],"description":"contains all the POST params","scope":"make_api_call","type":"array"},{"kind":128,"name":"$url","location":[261,50,261,54],"description":"endpoint url","scope":"make_api_call","type":"string"},{"kind":128,"name":"$type","location":[261,56,261,61],"description":"the type of request (tts/sms)\n","scope":"make_api_call","type":"int"}]},{"kind":32,"name":"validate_response","modifiers":4,"location":[303,4,313,5],"description":"Validates the response object in order to check that the SMS was sent\nor the TTS call was placed.","scope":"Phone\\Relay\\Nexmo","type":"bool","children":[{"kind":128,"name":"$response","location":[303,39,303,48],"description":"JSON response converted to array.","scope":"validate_response","type":"array"},{"kind":128,"name":"$type","location":[303,50,303,55],"description":"either SMS or TTS request.\n","scope":"validate_response","type":"int"}]},{"kind":32,"name":"validate_sms_response","modifiers":4,"location":[347,4,381,5],"description":"Validates that the API call returned a SUCCESS status for SMS requests.","scope":"Phone\\Relay\\Nexmo","type":"bool","children":[{"kind":128,"name":"$response","location":[347,43,347,52],"description":"JSON response converted to array\n","scope":"validate_sms_response","type":"array"}]},{"kind":32,"name":"validate_tts_response","modifiers":4,"location":[400,4,414,5],"description":"Validate that the API call returned a SUCCESS status for a TTS request.","scope":"Phone\\Relay\\Nexmo","type":"bool","children":[{"kind":128,"name":"$response","location":[400,43,400,52],"description":"JSON response converted to array\n","scope":"validate_tts_response","type":"array"}]},{"kind":32,"name":"error_log","modifiers":4,"location":[421,4,428,5],"description":"Print to error log","scope":"Phone\\Relay\\Nexmo","children":[{"kind":128,"name":"$text","location":[421,31,421,36],"scope":"error_log","type":"string"}]}]}]}}