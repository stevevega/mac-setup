{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/HH/Subscription/Step/ProfessionalInfo.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"HH\\Subscription\\Step","location":[11,0,11,31]},{"kind":1,"name":"RoleMapping","modifiers":4096,"location":[13,5,13,46],"associated":[{"kind":1,"name":"Communication\\Client\\Intercom\\RoleMapping"}]},{"kind":1,"name":"Timezone","modifiers":4096,"location":[14,5,14,21],"associated":[{"kind":1,"name":"HH\\Date\\Timezone"}]},{"kind":1,"name":"HHDoctor","modifiers":4096,"location":[15,5,15,26],"associated":[{"kind":1,"name":"HH\\Doctor"}]},{"kind":1,"name":"UserCache","modifiers":4096,"location":[16,5,16,38],"associated":[{"kind":1,"name":"HH\\Entity\\User\\Cache"}]},{"kind":1,"name":"RequestUtil","modifiers":4096,"location":[17,5,17,40],"associated":[{"kind":1,"name":"HH\\Http\\Request\\Util"}]},{"kind":1,"name":"MailSubscription","modifiers":4096,"location":[18,5,18,37],"associated":[{"kind":1,"name":"HH\\Mail\\Service\\MailSubscription"}]},{"kind":1,"name":"AuthorizationRoleSave","modifiers":4096,"location":[19,5,19,72],"associated":[{"kind":1,"name":"HH\\Request\\Handler\\Authorization\\Role\\Save"}]},{"kind":1,"name":"ObjectRequest","modifiers":4096,"location":[20,5,20,44],"associated":[{"kind":1,"name":"HH\\Request\\Type\\Object"}]},{"kind":1,"name":"DoctorEntitySearch","modifiers":4096,"location":[21,5,21,69],"associated":[{"kind":1,"name":"HH\\Search\\Cores\\CommonObject\\Doctor\\Entity"}]},{"kind":1,"name":"Status","modifiers":4096,"location":[22,5,22,14],"associated":[{"kind":1,"name":"HH\\Status"}]},{"kind":1,"name":"ASignUp","modifiers":4096,"location":[23,5,23,28],"associated":[{"kind":1,"name":"HH\\Subscription\\ASignUp"}]},{"kind":1,"name":"Coupon","modifiers":4096,"location":[24,5,24,27],"associated":[{"kind":1,"name":"HH\\Subscription\\Coupon"}]},{"kind":1,"name":"Plans","modifiers":4096,"location":[25,5,25,26],"associated":[{"kind":1,"name":"HH\\Subscription\\Plans"}]},{"kind":1,"name":"StripeTrial","modifiers":4096,"location":[26,5,26,48],"associated":[{"kind":1,"name":"HH\\Subscription\\Trial\\Stripe"}]},{"kind":1,"name":"TermsAndConditions","modifiers":4096,"location":[27,5,27,39],"associated":[{"kind":1,"name":"HH\\UI\\Dashboard\\TermsAndConditions"}]},{"kind":1,"name":"UserRole","modifiers":4096,"location":[28,5,28,29],"associated":[{"kind":1,"name":"HH\\User\\Role"}]},{"kind":1,"name":"Mixpanel","modifiers":4096,"location":[29,5,29,41],"associated":[{"kind":1,"name":"HH\\Util\\MixpanelTracking"}]},{"kind":1,"name":"UrlHandler","modifiers":4096,"location":[30,5,30,23],"associated":[{"kind":1,"name":"HH\\Util\\UrlHandler"}]},{"kind":1,"name":"JWTRequestor","modifiers":4096,"location":[31,5,31,61],"associated":[{"kind":1,"name":"Huli\\Authentication\\Client\\JWT\\Requestor"}]},{"kind":1,"name":"Token","modifiers":4096,"location":[32,5,32,30],"associated":[{"kind":1,"name":"Huli\\Authentication\\Token"}]},{"kind":1,"name":"Transaction","modifiers":4096,"location":[33,5,33,30],"associated":[{"kind":1,"name":"Huli\\Database\\Transaction"}]},{"kind":1,"name":"TaskQueue","modifiers":4096,"location":[34,5,34,40],"associated":[{"kind":1,"name":"Huli\\Http\\Request\\Handler\\TaskQueue"}]},{"kind":1,"name":"Nonce","modifiers":4096,"location":[35,5,35,21],"associated":[{"kind":1,"name":"Kima\\Crypt\\Nonce"}]},{"kind":1,"name":"Error","modifiers":4096,"location":[36,5,36,15],"associated":[{"kind":1,"name":"Kima\\Error"}]},{"kind":1,"name":"DoctorModel","modifiers":4096,"location":[37,5,37,32],"associated":[{"kind":1,"name":"Model\\Doctor"}]},{"kind":1,"name":"DoctorLicenseModel","modifiers":4096,"location":[38,5,38,60],"associated":[{"kind":1,"name":"Model\\Doctor\\Professional\\License"}]},{"kind":1,"name":"DoctorSpecialtyModel","modifiers":4096,"location":[39,5,39,51],"associated":[{"kind":1,"name":"Model\\Doctor\\Specialty"}]},{"kind":1,"name":"CountryModel","modifiers":4096,"location":[40,5,40,43],"associated":[{"kind":1,"name":"Model\\Location\\Country"}]},{"kind":1,"name":"ProfessionalLicenseModel","modifiers":4096,"location":[41,5,41,59],"associated":[{"kind":1,"name":"Model\\Professional\\License"}]},{"kind":1,"name":"SpecialtyModel","modifiers":4096,"location":[42,5,42,38],"associated":[{"kind":1,"name":"Model\\Specialty"}]},{"kind":1,"name":"SubscriptionModel","modifiers":4096,"location":[43,5,43,44],"associated":[{"kind":1,"name":"Model\\Subscription"}]},{"kind":1,"name":"UserModel","modifiers":4096,"location":[44,5,44,28],"associated":[{"kind":1,"name":"Model\\User"}]},{"kind":1,"name":"UserSubscriptionModel","modifiers":4096,"location":[45,5,45,53],"associated":[{"kind":1,"name":"Model\\User\\Subscription"}]},{"kind":1,"name":"UserSubscriptionSourceModel","modifiers":4096,"location":[46,5,46,66],"associated":[{"kind":1,"name":"Model\\User\\Subscription\\Source"}]},{"kind":1,"name":"Customer","modifiers":4096,"location":[47,5,47,21],"associated":[{"kind":1,"name":"Payment\\Customer"}]},{"kind":1,"name":"stdClass","modifiers":4096,"location":[48,4,48,12],"associated":[{"kind":1,"name":"stdClass"}]},{"kind":1,"name":"HH\\Subscription\\Step\\ProfessionalInfo","location":[53,0,768,1],"associated":[{"kind":1,"name":"HH\\Subscription\\ASignUp"}],"description":"This class handles the requests for the basic info screen","children":[{"kind":1024,"name":"DEFAULT_COUNTRY","modifiers":1,"location":[55,10,55,31],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","value":"188"},{"kind":1024,"name":"ID_PROFESSIONAL_LICENSE","modifiers":1,"location":[57,10,57,61],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","value":"'id_professional_license'"},{"kind":1024,"name":"LICENSE_NUMBER","modifiers":1,"location":[58,10,58,43],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","value":"'license_number'"},{"kind":1024,"name":"NO_LICENSE_AFFILIATION","modifiers":1,"location":[59,10,59,59],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","value":"'no_license_affiliation'"},{"kind":1024,"name":"INSTANCE_REQ","modifiers":1,"location":[60,10,60,44],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","value":"'instance_required'"},{"kind":1024,"name":"INVALID_SPECIALTIES","modifiers":1,"location":[62,10,62,80],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","value":"'Trying to save empty specialties for doctor %s'"},{"kind":16,"name":"$id_country","modifiers":1,"location":[64,11,64,27],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$id_doctor","modifiers":1,"location":[65,11,65,21],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$phone_number","modifiers":1,"location":[66,11,66,29],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$allow_contact","modifiers":1,"location":[67,11,67,32],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$specialties","modifiers":1,"location":[68,11,68,23],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$id_professional_license","modifiers":1,"location":[70,11,70,35],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$no_license_affiliation","modifiers":1,"location":[71,11,71,42],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$disable_country_select","modifiers":1,"location":[72,11,72,42],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":16,"name":"$request_fields_post","modifiers":2,"location":[79,14,99,5],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"array"},{"kind":16,"name":"$trial_end","modifiers":4,"location":[104,12,104,22],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"set_allow_contact","modifiers":1,"location":[111,4,114,5],"description":"Sets whether the user wants to be contacted for further offers","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$allow_contact","location":[111,38,111,52],"scope":"set_allow_contact","type":"string"}]},{"kind":32,"name":"set_specialties","modifiers":1,"location":[121,4,124,5],"description":"Sets the specialties, convert the string to an array of ints","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$specialties","location":[121,36,121,48],"scope":"set_specialties","type":"string"}]},{"kind":32,"name":"set_id_doctor","modifiers":1,"location":[132,4,139,5],"description":"Sets and validates the doctor id, it shouldn't be called when a name/lastname\nwas entered","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$id_doctor","location":[132,34,132,44],"scope":"set_id_doctor","type":"int"}]},{"kind":32,"name":"set_id_professional_license","modifiers":1,"location":[146,4,153,5],"description":"Sets and validates the professional license","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$id","location":[146,48,146,51],"scope":"set_id_professional_license","type":"int"}]},{"kind":32,"name":"set_id_country","modifiers":1,"location":[160,4,167,5],"description":"Sets and validates the selected country","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$country","location":[160,35,160,67],"scope":"set_id_country","value":"self::DEFAULT_COUNTRY","type":"int"}]},{"kind":32,"name":"has_no_license_affiliation","modifiers":1,"location":[175,4,178,5],"description":"Gets whether the user previously marked the option that indicates she\ndoesn't have any license affiliation","scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"bool"},{"kind":32,"name":"process_get","modifiers":1,"location":[183,4,195,5],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"process_post","modifiers":1,"location":[200,4,250,5],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"renderer","modifiers":1,"location":[257,4,260,5],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"string"},{"kind":32,"name":"urn","modifiers":1,"location":[267,4,270,5],"scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"string"},{"kind":32,"name":"load_subscription_data","modifiers":2,"location":[275,4,289,5],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"load_doctor","modifiers":2,"location":[297,4,307,5],"description":"Loads doctor data.\nMust be called after id_doctor is setup from payload","scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"post_process_subscription","modifiers":4,"location":[313,4,329,5],"description":"Handles all the remaining actions after creating an account, should only\nbe called until that point.","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"process_trial","modifiers":4,"location":[336,4,354,5],"description":"Generates the correct trial end date for the new subscription.","scope":"HH\\Subscription\\Step\\ProfessionalInfo","typeSource":1,"type":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"update_account_data","modifiers":4,"location":[359,4,378,5],"description":"Updates the user account and doctor profile","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"create_account_data","modifiers":4,"location":[386,4,393,5],"description":"Creates a new user account as some fields like the id are shared with the payment\nprocessor as metadata","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$transaction","location":[386,41,386,65],"scope":"create_account_data","typeSource":1,"type":"Huli\\Database\\Transaction"}]},{"kind":32,"name":"update_account","modifiers":4,"location":[400,4,445,5],"description":"Saves the doctor's user account","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$create_new","location":[400,36,400,55],"scope":"update_account","value":"false","type":"mixed"}]},{"kind":32,"name":"create_role_authorization","modifiers":4,"location":[454,4,464,5],"description":"Creates the role authorization for a new doctor user. Any error in the\nsecondary handler execution is appended to the current request handler.","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$transaction","location":[454,47,454,71],"description":"transaction object passed to the\nauthorization handler","scope":"create_role_authorization","typeSource":1,"type":"Huli\\Database\\Transaction"}]},{"kind":32,"name":"update_profile","modifiers":4,"location":[469,4,493,5],"description":"Saves the doctor profile","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"save_doctor_subscription","modifiers":4,"location":[501,4,536,5],"description":"Saves the subscription information by associating it to the corresponding\ndoctor profile","scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"save_specialties","modifiers":4,"location":[544,4,570,5],"description":"Saves the specialties related to the current doctor, this function must be\ncalled only when the doctor is new and not already part of a given medical association","scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"object"},{"kind":32,"name":"login","modifiers":4,"location":[575,4,591,5],"description":"Logs the current user after the account has been created.","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"track_user_signup","modifiers":4,"location":[597,4,602,5],"description":"This method tracks that a user completed the subscription\nprocess","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"get_customer_info","modifiers":4,"location":[607,4,624,5],"description":"Gets the customer information","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"apply_coupon","modifiers":4,"location":[631,4,640,5],"description":"Applies any coupon to the current subscription","scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"load_plan_country","modifiers":4,"location":[642,4,651,5],"scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"load_professional_license_country","modifiers":4,"location":[660,4,668,5],"description":"Loads the selected country to be the one associated to the\nprofessional instance if it has any, but only if the country hasn't\nbeen set before.","scope":"HH\\Subscription\\Step\\ProfessionalInfo","type":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"verify_user_is_available","modifiers":4,"location":[674,4,683,5],"description":"Verifies whether the user has or not an email set, this indicates if it\nis allowed to set a new one","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"verify_user_data","modifiers":4,"location":[688,4,714,5],"description":"Verify that the data passed by the user is valid and well formatted","scope":"HH\\Subscription\\Step\\ProfessionalInfo"},{"kind":32,"name":"prepare_professional_license","modifiers":4,"location":[723,4,749,5],"description":"Validates that professional license information is set and adds it to the\nsubscription object","scope":"HH\\Subscription\\Step\\ProfessionalInfo","children":[{"kind":128,"name":"$force","location":[723,50,723,64],"description":"force validation of the fields without caring whether\nthe user is affiliated to a licensing institution","scope":"prepare_professional_license","value":"false","type":"bool"}]},{"kind":32,"name":"load_doctor_profile","modifiers":4,"location":[755,4,767,5],"description":"Loads the doctor profile in case the user has reloaded the page or otherwise\ngone back in the process","scope":"HH\\Subscription\\Step\\ProfessionalInfo"}]}]}}