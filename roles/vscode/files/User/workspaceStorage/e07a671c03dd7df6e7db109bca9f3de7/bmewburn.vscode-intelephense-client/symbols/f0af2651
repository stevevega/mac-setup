{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/HH/Mail/Handler/Subscription/UpgradeMailer.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"HH\\Mail\\Handler\\Subscription","location":[11,0,11,39]},{"kind":1,"name":"MailHandler","modifiers":4096,"location":[13,5,13,24],"associated":[{"kind":1,"name":"HH\\Mail\\MailHandler"}]},{"kind":1,"name":"Template","modifiers":4096,"location":[14,5,14,26],"associated":[{"kind":1,"name":"HH\\Mail\\Util\\Template"}]},{"kind":1,"name":"MarketingGroup","modifiers":4096,"location":[15,5,15,35],"associated":[{"kind":1,"name":"HH\\Subscription\\MarketingGroup"}]},{"kind":1,"name":"Plans","modifiers":4096,"location":[16,5,16,26],"associated":[{"kind":1,"name":"HH\\Subscription\\Plans"}]},{"kind":1,"name":"Error","modifiers":4096,"location":[17,5,17,15],"associated":[{"kind":1,"name":"Kima\\Error"}]},{"kind":1,"name":"L10n","modifiers":4096,"location":[18,5,18,14],"associated":[{"kind":1,"name":"Kima\\L10n"}]},{"kind":1,"name":"Composer","modifiers":4096,"location":[19,5,19,18],"associated":[{"kind":1,"name":"Mail\\Composer"}]},{"kind":1,"name":"DoctorModel","modifiers":4096,"location":[20,5,20,32],"associated":[{"kind":1,"name":"Model\\Doctor"}]},{"kind":1,"name":"UserSubscriptionModel","modifiers":4096,"location":[21,5,21,53],"associated":[{"kind":1,"name":"Model\\User\\Subscription"}]},{"kind":1,"name":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","location":[26,0,275,1],"associated":[{"kind":1,"name":"HH\\Mail\\MailHandler"}],"description":"This class handles sending the email verification emails","children":[{"kind":1024,"name":"ID_USER_SUBSCRIPTION","modifiers":1,"location":[31,10,31,55],"scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","value":"'id_user_subscription'"},{"kind":1024,"name":"ID_PREVIOUS_SUBSCRIPTION","modifiers":1,"location":[32,10,32,63],"scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","value":"'id_previous_subscription'"},{"kind":16,"name":"$curr_sub","modifiers":4,"location":[39,12,39,21],"scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","type":"Model\\User\\Subscription"},{"kind":16,"name":"$prev_sub","modifiers":4,"location":[46,12,46,21],"scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","type":"Model\\User\\Subscription"},{"kind":16,"name":"$tags","modifiers":2,"location":[53,14,53,62],"scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","type":"array"},{"kind":16,"name":"$request_fields","modifiers":36,"location":[60,19,63,5],"scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","type":"array"},{"kind":32,"name":"load_current_subscription","modifiers":4,"location":[70,4,87,5],"description":"Load current subscription","scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","typeSource":1,"type":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer"},{"kind":32,"name":"load_previous_subscription","modifiers":4,"location":[94,4,111,5],"description":"Load previous subscription","scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","typeSource":1,"type":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer"},{"kind":32,"name":"send","modifiers":1,"location":[116,4,151,5],"description":"Send upgrade mail","scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer"},{"kind":32,"name":"send_email_to_doctor","modifiers":4,"location":[156,4,199,5],"description":"Prepares the email send to patient about the plan change","scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","children":[{"kind":128,"name":"$user","location":[156,42,156,47],"scope":"send_email_to_doctor"},{"kind":128,"name":"$curr","location":[156,49,156,62],"scope":"send_email_to_doctor","typeSource":1,"type":"HH\\Mail\\Handler\\Subscription\\DataSub"},{"kind":128,"name":"$prev","location":[156,64,156,77],"scope":"send_email_to_doctor","typeSource":1,"type":"HH\\Mail\\Handler\\Subscription\\DataSub"}]},{"kind":32,"name":"build_features","modifiers":4,"location":[207,4,235,5],"description":"Process marketing groups and plan features","scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","children":[{"kind":128,"name":"$plan","location":[207,36,207,41],"scope":"build_features","type":"string"},{"kind":128,"name":"$params","location":[207,43,207,51],"scope":"build_features","type":"array"}]},{"kind":32,"name":"send_email_to_admin_account","modifiers":4,"location":[244,4,274,5],"description":"Builds and sends and email to the admin account","scope":"HH\\Mail\\Handler\\Subscription\\UpgradeMailer","children":[{"kind":128,"name":"$d","location":[244,49,244,59],"description":"parsed doc info","scope":"send_email_to_admin_account","typeSource":1,"type":"HH\\Mail\\Handler\\Subscription\\DataDoc"},{"kind":128,"name":"$curr","location":[244,61,244,74],"description":"current subscription","scope":"send_email_to_admin_account","typeSource":1,"type":"HH\\Mail\\Handler\\Subscription\\DataSub"},{"kind":128,"name":"$prev","location":[244,76,244,89],"description":"previous subscription","scope":"send_email_to_admin_account","typeSource":1,"type":"HH\\Mail\\Handler\\Subscription\\DataSub"}]}]}]}}