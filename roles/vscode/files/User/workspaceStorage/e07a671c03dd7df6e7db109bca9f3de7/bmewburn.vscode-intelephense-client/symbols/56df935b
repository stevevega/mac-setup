{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/HH/Export/Manager/Handler.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"HH\\Export\\Manager","location":[11,0,11,28]},{"kind":1,"name":"IPath","modifiers":4096,"location":[13,5,13,25],"associated":[{"kind":1,"name":"HH\\Export\\Core\\IPath"}]},{"kind":1,"name":"Path","modifiers":4096,"location":[14,5,14,24],"associated":[{"kind":1,"name":"HH\\Export\\Core\\Path"}]},{"kind":1,"name":"HHLanguage","modifiers":4096,"location":[15,5,15,30],"associated":[{"kind":1,"name":"HH\\Language"}]},{"kind":1,"name":"ExportRecordService","modifiers":4096,"location":[16,5,16,55],"associated":[{"kind":1,"name":"HH\\MailService\\ExportRecord"}]},{"kind":1,"name":"ISession","modifiers":4096,"location":[17,5,17,33],"associated":[{"kind":1,"name":"Huli\\Authentication\\ISession"}]},{"kind":1,"name":"Transaction","modifiers":4096,"location":[18,5,18,30],"associated":[{"kind":1,"name":"Huli\\Database\\Transaction"}]},{"kind":1,"name":"Nonce","modifiers":4096,"location":[19,5,19,21],"associated":[{"kind":1,"name":"Kima\\Crypt\\Nonce"}]},{"kind":1,"name":"Error","modifiers":4096,"location":[20,5,20,15],"associated":[{"kind":1,"name":"Kima\\Error"}]},{"kind":1,"name":"PatientExportDocumentModel","modifiers":4096,"location":[21,5,21,63],"associated":[{"kind":1,"name":"Model\\Patient\\ExportDocument"}]},{"kind":1,"name":"UserModel","modifiers":4096,"location":[22,5,22,28],"associated":[{"kind":1,"name":"Model\\User"}]},{"kind":1,"name":"stdClass","modifiers":4096,"location":[23,5,23,13],"associated":[{"kind":1,"name":"stdClass"}]},{"kind":1,"name":"HH\\Export\\Manager\\Handler","modifiers":8,"location":[28,0,279,1],"description":"Orchestrator class that manage all the process to export records","children":[{"kind":1024,"name":"ERROR_CREATE_TMP_PATH","modifiers":1,"location":[33,10,33,89],"scope":"HH\\Export\\Manager\\Handler","value":"'Error create tmp path: %s. With the error message: %s'"},{"kind":1024,"name":"WARNING_REMOVE_FILE","modifiers":1,"location":[34,10,34,54],"scope":"HH\\Export\\Manager\\Handler","value":"'Error remove file %s'"},{"kind":1024,"name":"ERROR_SAVING_IN_MODEL","modifiers":1,"location":[35,10,35,61],"scope":"HH\\Export\\Manager\\Handler","value":"'Error saving in the model'"},{"kind":1024,"name":"WARNING_REMOVE_FOLDER","modifiers":1,"location":[36,10,36,58],"scope":"HH\\Export\\Manager\\Handler","value":"'Error remove folder %s'"},{"kind":1024,"name":"TMP_PATH","modifiers":1,"location":[41,10,41,28],"scope":"HH\\Export\\Manager\\Handler","value":"'/tmp/'"},{"kind":16,"name":"$data","modifiers":4,"location":[48,12,48,17],"scope":"HH\\Export\\Manager\\Handler","type":"stdClass"},{"kind":16,"name":"$id_user","modifiers":4,"location":[55,12,55,20],"scope":"HH\\Export\\Manager\\Handler","type":"int"},{"kind":16,"name":"$tmp_folder_path","modifiers":4,"location":[62,12,62,28],"scope":"HH\\Export\\Manager\\Handler","type":"string"},{"kind":16,"name":"$session","modifiers":4,"location":[69,12,69,20],"scope":"HH\\Export\\Manager\\Handler","type":"Huli\\Authentication\\ISession"},{"kind":32,"name":"__construct","modifiers":1,"location":[80,4,87,5],"description":"Sets the value of session, data, id_user and id_language","scope":"HH\\Export\\Manager\\Handler","children":[{"kind":128,"name":"$transaction","location":[80,32,80,56],"scope":"__construct","typeSource":1,"type":"Huli\\Database\\Transaction"},{"kind":128,"name":"$session","location":[80,58,80,75],"scope":"__construct","typeSource":1,"type":"Huli\\Authentication\\ISession"},{"kind":128,"name":"$data","location":[80,77,80,82],"scope":"__construct","type":"stdClass"},{"kind":128,"name":"$id_user","location":[80,84,80,92],"scope":"__construct","type":"int"},{"kind":128,"name":"$id_language","location":[80,94,80,106],"scope":"__construct","type":"int"}]},{"kind":32,"name":"export","modifiers":1,"location":[92,4,111,5],"description":"Exports the records of the doctor in a zip file","scope":"HH\\Export\\Manager\\Handler"},{"kind":32,"name":"get_documents","modifiers":4,"location":[120,4,124,5],"description":"Downloads all the documents associated with the user","scope":"HH\\Export\\Manager\\Handler","type":"HH\\Export\\Core\\IPath","children":[{"kind":128,"name":"$iso","location":[120,35,120,39],"scope":"get_documents","type":"string"}]},{"kind":32,"name":"get_xlsx","modifiers":4,"location":[134,4,138,5],"description":"Creates a xlsx file with all the data of the user","scope":"HH\\Export\\Manager\\Handler","type":"HH\\Export\\Core\\IPath","children":[{"kind":128,"name":"$iso","location":[134,30,134,34],"scope":"get_xlsx","type":"string"},{"kind":128,"name":"$user_name","location":[134,36,134,46],"scope":"get_xlsx","type":"string"}]},{"kind":32,"name":"create_zip","modifiers":4,"location":[149,4,153,5],"description":"Creates a zip with the xlsx file and the documents of the user","scope":"HH\\Export\\Manager\\Handler","type":"HH\\Export\\Core\\IPath","children":[{"kind":128,"name":"$document_path","location":[149,32,149,52],"scope":"create_zip","typeSource":1,"type":"HH\\Export\\Core\\IPath"},{"kind":128,"name":"$xlsx_path","location":[149,54,149,70],"scope":"create_zip","typeSource":1,"type":"HH\\Export\\Core\\IPath"},{"kind":128,"name":"$user_name","location":[149,72,149,82],"scope":"create_zip","type":"string"}]},{"kind":32,"name":"upload_zip_file","modifiers":4,"location":[162,4,190,5],"description":"Upload the zip file to S3","scope":"HH\\Export\\Manager\\Handler","type":"int","children":[{"kind":128,"name":"$zip_path","location":[162,37,162,52],"scope":"upload_zip_file","typeSource":1,"type":"HH\\Export\\Core\\IPath"}]},{"kind":32,"name":"send_email","modifiers":4,"location":[199,4,204,5],"description":"Sends an email with the instruction to recover the records","scope":"HH\\Export\\Manager\\Handler","type":"HH\\Export\\Manager\\Handler","children":[{"kind":128,"name":"$id_patient_export_document","location":[199,32,199,59],"scope":"send_email","type":"int"}]},{"kind":32,"name":"get_public_id","modifiers":4,"location":[210,4,223,5],"description":"Sets the value of public_id. Validates that the value does not exists in DB,\nelse try with another value","scope":"HH\\Export\\Manager\\Handler"},{"kind":32,"name":"create_temporary_folder","modifiers":4,"location":[230,4,247,5],"description":"Creates a temporary folder where to put the doctor data","scope":"HH\\Export\\Manager\\Handler","type":"HH\\Export\\Manager\\Handler"},{"kind":32,"name":"delete_directory_tree","modifiers":4,"location":[256,4,278,5],"description":"Deletes all the files and folders of a directory recursively","scope":"HH\\Export\\Manager\\Handler","type":"bool","children":[{"kind":128,"name":"$dir","location":[256,43,256,47],"scope":"delete_directory_tree","type":"string"}]}]}]}}