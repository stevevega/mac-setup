{"uri":"file:///Users/vega/Code/huli/manager-web/src/application/model/User/Subscription.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"Model\\User","location":[11,0,11,21]},{"kind":1,"name":"Model","modifiers":4096,"location":[13,5,13,15],"associated":[{"kind":1,"name":"Kima\\Model"}]},{"kind":1,"name":"CurrencyModel","modifiers":4096,"location":[14,5,14,36],"associated":[{"kind":1,"name":"Model\\Currency"}]},{"kind":1,"name":"DoctorModel","modifiers":4096,"location":[15,5,15,32],"associated":[{"kind":1,"name":"Model\\Doctor"}]},{"kind":1,"name":"CountryModel","modifiers":4096,"location":[16,5,16,43],"associated":[{"kind":1,"name":"Model\\Location\\Country"}]},{"kind":1,"name":"TimezoneModel","modifiers":4096,"location":[17,5,17,45],"associated":[{"kind":1,"name":"Model\\Location\\Timezone"}]},{"kind":1,"name":"PlanModel","modifiers":4096,"location":[18,5,18,28],"associated":[{"kind":1,"name":"Model\\Plan"}]},{"kind":1,"name":"PlanL10nModel","modifiers":4096,"location":[19,5,19,37],"associated":[{"kind":1,"name":"Model\\Plan\\L10n"}]},{"kind":1,"name":"UserModel","modifiers":4096,"location":[20,5,20,28],"associated":[{"kind":1,"name":"Model\\User"}]},{"kind":1,"name":"UserSubscriptionSourceModel","modifiers":4096,"location":[21,5,21,66],"associated":[{"kind":1,"name":"Model\\User\\Subscription\\Source"}]},{"kind":1,"name":"Model\\User\\Subscription","location":[26,0,994,1],"associated":[{"kind":1,"name":"Kima\\Model"}],"description":"Model class for the user_subscription table","children":[{"kind":1024,"name":"TABLE","modifiers":1,"location":[31,10,31,37],"scope":"Model\\User\\Subscription","value":"'user_subscription'"},{"kind":1024,"name":"TP","modifiers":1,"location":[32,10,32,32],"scope":"Model\\User\\Subscription","value":"self::TABLE . '.'"},{"kind":1024,"name":"F_ACTIVE","modifiers":1,"location":[37,10,37,29],"scope":"Model\\User\\Subscription","value":"'active'"},{"kind":1024,"name":"F_ACTIVE_UNTIL","modifiers":1,"location":[38,10,38,41],"scope":"Model\\User\\Subscription","value":"'active_until'"},{"kind":1024,"name":"F_ALLOW_CONTACT","modifiers":1,"location":[39,10,39,43],"scope":"Model\\User\\Subscription","value":"'allow_contact'"},{"kind":1024,"name":"F_CANCELLATION_REASON_KEY","modifiers":1,"location":[40,10,40,63],"scope":"Model\\User\\Subscription","value":"'cancellation_reason_key'"},{"kind":1024,"name":"F_CANCELLATION_REASON_TEXT","modifiers":1,"location":[41,10,41,65],"scope":"Model\\User\\Subscription","value":"'cancellation_reason_text'"},{"kind":1024,"name":"F_CANCELLED_ON","modifiers":1,"location":[42,10,42,41],"scope":"Model\\User\\Subscription","value":"'cancelled_on'"},{"kind":1024,"name":"F_CREATED_ON","modifiers":1,"location":[43,10,43,37],"scope":"Model\\User\\Subscription","value":"'created_on'"},{"kind":1024,"name":"F_HAS_CARD","modifiers":1,"location":[44,10,44,33],"scope":"Model\\User\\Subscription","value":"'has_card'"},{"kind":1024,"name":"F_ID_PLAN","modifiers":1,"location":[45,10,45,31],"scope":"Model\\User\\Subscription","value":"'id_plan'"},{"kind":1024,"name":"F_ID_STRIPE_CUSTOMER","modifiers":1,"location":[46,10,46,53],"scope":"Model\\User\\Subscription","value":"'id_stripe_customer'"},{"kind":1024,"name":"F_ID_USER","modifiers":1,"location":[47,10,47,31],"scope":"Model\\User\\Subscription","value":"'id_user'"},{"kind":1024,"name":"F_ID_USER_MODIFIED_BY","modifiers":1,"location":[48,10,48,55],"scope":"Model\\User\\Subscription","value":"'id_user_modified_by'"},{"kind":1024,"name":"F_ID_USER_SUBSCRIPTION","modifiers":1,"location":[49,10,49,57],"scope":"Model\\User\\Subscription","value":"'id_user_subscription'"},{"kind":1024,"name":"F_ID_USER_SUBSCRIPTION_SOURCE","modifiers":1,"location":[50,10,50,71],"scope":"Model\\User\\Subscription","value":"'id_user_subscription_source'"},{"kind":1024,"name":"F_IS_PROCESSED_MANUALLY","modifiers":1,"location":[51,10,51,59],"scope":"Model\\User\\Subscription","value":"'is_processed_manually'"},{"kind":1024,"name":"F_MODIFIED_ON","modifiers":1,"location":[52,10,52,39],"scope":"Model\\User\\Subscription","value":"'modified_on'"},{"kind":1024,"name":"F_PRICE","modifiers":1,"location":[53,10,53,27],"scope":"Model\\User\\Subscription","value":"'price'"},{"kind":1024,"name":"F_TRIAL_END_ON","modifiers":1,"location":[54,10,54,41],"scope":"Model\\User\\Subscription","value":"'trial_end_on'"},{"kind":1024,"name":"F_TRIAL_GRACE_HOURS","modifiers":1,"location":[55,10,55,51],"scope":"Model\\User\\Subscription","value":"'trial_grace_hours'"},{"kind":1024,"name":"F_TRIAL_LENGTH","modifiers":1,"location":[56,10,56,41],"scope":"Model\\User\\Subscription","value":"'trial_length'"},{"kind":1024,"name":"ACTIVE","modifiers":1,"location":[61,10,61,44],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ACTIVE"},{"kind":1024,"name":"ACTIVE_UNTIL","modifiers":1,"location":[62,10,62,56],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ACTIVE_UNTIL"},{"kind":1024,"name":"ALLOW_CONTACT","modifiers":1,"location":[63,10,63,58],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ALLOW_CONTACT"},{"kind":1024,"name":"CANCELLATION_REASON_KEY","modifiers":1,"location":[64,10,64,78],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_CANCELLATION_REASON_KEY"},{"kind":1024,"name":"CANCELLATION_REASON_TEXT","modifiers":1,"location":[65,10,65,80],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_CANCELLATION_REASON_TEXT"},{"kind":1024,"name":"CANCELLED_ON","modifiers":1,"location":[66,10,66,56],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_CANCELLED_ON"},{"kind":1024,"name":"CREATED_ON","modifiers":1,"location":[67,10,67,52],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_CREATED_ON"},{"kind":1024,"name":"HAS_CARD","modifiers":1,"location":[68,10,68,48],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_HAS_CARD"},{"kind":1024,"name":"ID_PLAN","modifiers":1,"location":[69,10,69,46],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ID_PLAN"},{"kind":1024,"name":"ID_STRIPE_CUSTOMER","modifiers":1,"location":[70,10,70,68],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ID_STRIPE_CUSTOMER"},{"kind":1024,"name":"ID_USER","modifiers":1,"location":[71,10,71,46],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ID_USER"},{"kind":1024,"name":"ID_USER_MODIFIED_BY","modifiers":1,"location":[72,10,72,70],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ID_USER_MODIFIED_BY"},{"kind":1024,"name":"ID_USER_SUBSCRIPTION","modifiers":1,"location":[73,10,73,72],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ID_USER_SUBSCRIPTION"},{"kind":1024,"name":"ID_USER_SUBSCRIPTION_SOURCE","modifiers":1,"location":[74,10,74,86],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_ID_USER_SUBSCRIPTION_SOURCE"},{"kind":1024,"name":"IS_PROCESSED_MANUALLY","modifiers":1,"location":[75,10,75,74],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_IS_PROCESSED_MANUALLY"},{"kind":1024,"name":"MODIFIED_ON","modifiers":1,"location":[76,10,76,54],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_MODIFIED_ON"},{"kind":1024,"name":"PRICE","modifiers":1,"location":[77,10,77,42],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_PRICE"},{"kind":1024,"name":"TRIAL_END_ON","modifiers":1,"location":[78,10,78,56],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_TRIAL_END_ON"},{"kind":1024,"name":"TRIAL_GRACE_HOURS","modifiers":1,"location":[79,10,79,66],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_TRIAL_GRACE_HOURS"},{"kind":1024,"name":"TRIAL_LENGTH","modifiers":1,"location":[80,10,80,56],"scope":"Model\\User\\Subscription","value":"self::TP . self::F_TRIAL_LENGTH"},{"kind":1024,"name":"STATE_ACTIVE","modifiers":1,"location":[82,10,82,26],"scope":"Model\\User\\Subscription","value":"1"},{"kind":1024,"name":"STATE_INACTIVE","modifiers":1,"location":[83,10,83,28],"scope":"Model\\User\\Subscription","value":"0"},{"kind":32,"name":"get_by_id_user_subscription","modifiers":33,"location":[92,4,98,5],"description":"Retrieves a single instance of a subscription and returns it","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id","location":[92,55,92,58],"description":"the id of the subscription\n","scope":"get_by_id_user_subscription","type":"string"}]},{"kind":32,"name":"get_for_charge_email","modifiers":1,"location":[107,4,115,5],"description":"Retrieves a single instance of a subscription and returns it","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription|null","children":[{"kind":128,"name":"$id","location":[107,41,107,51],"description":"the id of the Draft\n","scope":"get_for_charge_email","typeSource":1,"type":"string"}]},{"kind":32,"name":"get_by_id_user","modifiers":1,"location":[124,4,133,5],"description":"Retrieves a single instance by id user that is also active","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id_user","location":[124,35,124,47],"scope":"get_by_id_user","typeSource":1,"type":"int"}]},{"kind":32,"name":"get_by_id_doctor","modifiers":33,"location":[142,4,149,5],"description":"Retrieves the subscription data for the passed doctor","scope":"Model\\User\\Subscription","type":"object","children":[{"kind":128,"name":"$id_doctor","location":[142,44,142,54],"scope":"get_by_id_doctor","type":"int"}]},{"kind":32,"name":"get_for_upgrade","modifiers":1,"location":[159,4,186,5],"description":"Retrieves the user subscription for use in the upgrade process","scope":"Model\\User\\Subscription","type":"Subscription","children":[{"kind":128,"name":"$id_user","location":[159,36,159,44],"description":"user with a subscription","scope":"get_for_upgrade","type":"int"},{"kind":128,"name":"$id_language","location":[159,46,159,58],"description":"user language for l10n fields\n","scope":"get_for_upgrade","type":"int"}]},{"kind":32,"name":"get_for_subscription_wrapper","modifiers":1,"location":[199,4,211,5],"description":"Retrieve subscription with fields used by wrapper for\nhandling subscriptions actions like cancel, copy, sync","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription|null","children":[{"kind":128,"name":"$id_user","location":[199,49,199,61],"scope":"get_for_subscription_wrapper","typeSource":1,"type":"int"},{"kind":128,"name":"$fields","location":[199,63,199,76],"scope":"get_for_subscription_wrapper","type":"array"}]},{"kind":32,"name":"get_for_has_card_validation","modifiers":1,"location":[220,4,231,5],"description":"Retrieves the user subscription for use in the subscription context","scope":"Model\\User\\Subscription","type":"Subscription","children":[{"kind":128,"name":"$id_user","location":[220,48,220,56],"description":"user with a subscription\n","scope":"get_for_has_card_validation","type":"int"}]},{"kind":32,"name":"get_for_account_update","modifiers":1,"location":[240,4,249,5],"description":"Retrieves a single instance by id user that is also active","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id_user","location":[240,43,240,51],"scope":"get_for_account_update","type":"int"}]},{"kind":32,"name":"get_for_upgrade_email","modifiers":1,"location":[258,4,271,5],"description":"Gets subscription details for the emails sent on upgrade","scope":"Model\\User\\Subscription","typeSource":1,"type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id_user_sub","location":[258,42,258,58],"description":"user subscription\n","scope":"get_for_upgrade_email","typeSource":1,"type":"int"}]},{"kind":32,"name":"get_for_welcome_email","modifiers":1,"location":[281,4,296,5],"description":"Gets subscription details for the emails sent when a user signs up\nfor the first time.","scope":"Model\\User\\Subscription","typeSource":1,"type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id_user","location":[281,42,281,50],"description":"user id\n","scope":"get_for_welcome_email","type":"int"}]},{"kind":32,"name":"get_for_trial_email","modifiers":1,"location":[305,4,321,5],"description":"Gets subscription details for the emails sent about trial status","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$filter","location":[305,40,305,58],"description":"user id or stripe customer filter\n","scope":"get_for_trial_email","value":"[]","type":"array"}]},{"kind":32,"name":"get_for_billing_source_customer_create","modifiers":1,"location":[331,4,345,5],"description":"Gets the subscription details for billing source customer creation\nMainly data required for a payment processor account creation (customer)","scope":"Model\\User\\Subscription","typeSource":1,"type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id_user","location":[331,59,331,71],"scope":"get_for_billing_source_customer_create","typeSource":1,"type":"int"}]},{"kind":32,"name":"get_all_subscriptions_for_trial_maintenance","modifiers":1,"location":[352,4,373,5],"description":"Gets all subscriptions for trial maintenance analysis","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"get_to_be_cancelled_for_maintenance","modifiers":1,"location":[383,4,391,5],"description":"Retrieves all the active subscriptions whose active_until datetime has\nalready passed.","scope":"Model\\User\\Subscription","type":"array","children":[{"kind":128,"name":"$date","location":[383,56,383,61],"scope":"get_to_be_cancelled_for_maintenance","type":"mixed"}]},{"kind":32,"name":"get_all_subscriptions_for_admin","modifiers":1,"location":[402,4,440,5],"description":"Retrieves a list of all the subscriptions, current and past that a user\nmight have","scope":"Model\\User\\Subscription","type":"array","children":[{"kind":128,"name":"$id_user","location":[402,52,402,60],"scope":"get_all_subscriptions_for_admin","type":"int"},{"kind":128,"name":"$id_language","location":[402,62,402,74],"scope":"get_all_subscriptions_for_admin","type":"int"}]},{"kind":32,"name":"get_user_lang_for_invoice","modifiers":1,"location":[450,4,464,5],"description":"Returns the user id and language data for the passed subscription\nas long as it is currently active","scope":"Model\\User\\Subscription","type":"Model\\User\\this","children":[{"kind":128,"name":"$id_stripe_customer","location":[450,46,450,65],"scope":"get_user_lang_for_invoice","type":"string"}]},{"kind":32,"name":"get_for_practice_account","modifiers":1,"location":[475,4,493,5],"description":"Retrieve subscription details to be used in the \"Account\" section in\nthe practice app.","scope":"Model\\User\\Subscription","type":"Subscrption","children":[{"kind":128,"name":"$id_user","location":[475,45,475,53],"scope":"get_for_practice_account","type":"int"},{"kind":128,"name":"$id_language","location":[475,55,475,67],"scope":"get_for_practice_account","type":"int"}]},{"kind":32,"name":"get_plan_for_context_by_id_user","modifiers":1,"location":[504,4,525,5],"description":"Return plan information for context resource","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id_user","location":[504,52,504,60],"description":"user id","scope":"get_plan_for_context_by_id_user","type":"int"},{"kind":128,"name":"$id_language","location":[504,62,504,74],"description":"used to retrieve the plan names in the right\nlanguage for the current user.\n","scope":"get_plan_for_context_by_id_user","type":"int"}]},{"kind":32,"name":"get_subscription_client_side_vars","modifiers":1,"location":[534,4,548,5],"description":"Retrieves user subscription parameters for client side vars","scope":"Model\\User\\Subscription","type":"array","children":[{"kind":128,"name":"$id_user","location":[534,54,534,62],"scope":"get_subscription_client_side_vars"}]},{"kind":32,"name":"get_stripe_customer_for_addon","modifiers":1,"location":[557,4,568,5],"description":"Retrieves the stripe id if any.","scope":"Model\\User\\Subscription","type":"string","children":[{"kind":128,"name":"$id_user","location":[557,50,557,58],"scope":"get_stripe_customer_for_addon","type":"int"}]},{"kind":32,"name":"get_for_unsubscribe_flow","modifiers":1,"location":[578,4,597,5],"description":"Retrieves the subscription information required during an unsubscribe flow.","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription|null","children":[{"kind":128,"name":"$id_user","location":[578,45,578,57],"description":"owner of the subscription","scope":"get_for_unsubscribe_flow","typeSource":1,"type":"int"},{"kind":128,"name":"$id_language","location":[578,59,578,75],"scope":"get_for_unsubscribe_flow","typeSource":1,"type":"int"}]},{"kind":32,"name":"get_for_unsubscribe_email","modifiers":1,"location":[607,4,621,5],"description":"Gets the subscription object to be used on the unsubscribe email sent\nto doctors and admin.","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id","location":[607,46,607,49],"description":"the user subscription id.\n","scope":"get_for_unsubscribe_email","type":"int"}]},{"kind":32,"name":"get_for_loader","modifiers":1,"location":[630,4,639,5],"description":"Returns a subscription object to be used in the common loader.","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id","location":[630,35,630,38],"description":"user id\n","scope":"get_for_loader","type":"int"}]},{"kind":32,"name":"get_signup_date_for_client_vars","modifiers":1,"location":[648,4,659,5],"description":"Retrieves the date of the first user subscription created\nby a user, despite if it is active or not. This information is used\nin the communication handler.","scope":"Model\\User\\Subscription","children":[{"kind":128,"name":"$id_user","location":[648,52,648,64],"description":"of the user that will be checked","scope":"get_signup_date_for_client_vars","typeSource":1,"type":"int"}]},{"kind":32,"name":"save","modifiers":1,"location":[666,4,706,5],"description":"Saves subscription","scope":"Model\\User\\Subscription","type":"bool"},{"kind":32,"name":"save_for_signup","modifiers":1,"location":[713,4,726,5],"description":"Saves the passed subscription at signup process","scope":"Model\\User\\Subscription","type":"bool"},{"kind":32,"name":"save_has_card","modifiers":1,"location":[733,4,740,5],"description":"Updates has_card status (reduce stripe calls)","scope":"Model\\User\\Subscription","type":"Model\\User\\booolean"},{"kind":32,"name":"cancel","modifiers":1,"location":[747,4,757,5],"description":"Cancels the current subscription","scope":"Model\\User\\Subscription","type":"bool"},{"kind":32,"name":"cancel_for_unsubscribe","modifiers":1,"location":[764,4,774,5],"description":"Cancels the current subscription but doesn't deactivates it.","scope":"Model\\User\\Subscription","type":"bool"},{"kind":32,"name":"terminate","modifiers":1,"location":[781,4,788,5],"description":"Terminates the subscription, this simply deactivates it.","scope":"Model\\User\\Subscription","type":"bool"},{"kind":32,"name":"terminate_with_reason","modifiers":1,"location":[795,4,806,5],"description":"Terminates the subscription, this simply deactivates it.","scope":"Model\\User\\Subscription","type":"bool"},{"kind":32,"name":"can_user_upgrade","modifiers":1,"location":[816,4,828,5],"description":"Returns whether a given user can upgrade her plan. Most of the plans\nare upgradeable with the exception of the priciest ones.","scope":"Model\\User\\Subscription","type":"bool","children":[{"kind":128,"name":"$id_user","location":[816,37,816,45],"scope":"can_user_upgrade","type":"int"}]},{"kind":32,"name":"get_last_id_user_subscription","modifiers":33,"location":[835,4,842,5],"description":"Gets the last id user_subscription in the user subscription's table","scope":"Model\\User\\Subscription","type":"int"},{"kind":32,"name":"get_common_fields","modifiers":36,"location":[849,4,879,5],"description":"Returns an array of the fields usually retrieved in this model","scope":"Model\\User\\Subscription","type":"array"},{"kind":32,"name":"join_plan","modifiers":4,"location":[886,4,893,5],"description":"Join with the plan table","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"join_doctor","modifiers":4,"location":[900,4,907,5],"description":"Join with the doctor table","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"join_user","modifiers":4,"location":[914,4,921,5],"description":"Join with the user table","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"join_plan_l10n","modifiers":4,"location":[928,4,935,5],"description":"Joins with the plans l10n table using the plan id","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"join_plan_country","modifiers":4,"location":[942,4,949,5],"description":"Joins with the country table using the plan country","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"join_user_subscription_source","modifiers":4,"location":[956,4,966,5],"description":"Joins with the user subscription source table","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"join_currency","modifiers":4,"location":[973,4,980,5],"description":"Joins with the currency table using the plan currency","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"},{"kind":32,"name":"join_tz","modifiers":4,"location":[987,4,993,5],"description":"Joins with the timezone model, requires a join with user","scope":"Model\\User\\Subscription","type":"Model\\User\\Subscription"}]}]}}