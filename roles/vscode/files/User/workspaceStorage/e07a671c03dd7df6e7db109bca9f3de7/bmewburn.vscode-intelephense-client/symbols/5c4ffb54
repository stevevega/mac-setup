{"uri":"file:///Users/vega/Code/huli/manager-web/src/application/model/Draft/ADraft.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"model\\Draft","location":[11,0,11,22]},{"kind":1,"name":"DateTime","modifiers":4096,"location":[13,5,13,13],"associated":[{"kind":1,"name":"DateTime"}]},{"kind":1,"name":"Status","modifiers":4096,"location":[14,5,14,20],"associated":[{"kind":1,"name":"HH\\Draft\\Status"}]},{"kind":1,"name":"UTCDateTime","modifiers":4096,"location":[15,5,15,30],"associated":[{"kind":1,"name":"HH\\Util\\Mongo\\UTCDateTime"}]},{"kind":1,"name":"ISession","modifiers":4096,"location":[16,5,16,33],"associated":[{"kind":1,"name":"Huli\\Authentication\\ISession"}]},{"kind":1,"name":"Error","modifiers":4096,"location":[17,5,17,15],"associated":[{"kind":1,"name":"Kima\\Error"}]},{"kind":1,"name":"Model","modifiers":4096,"location":[18,5,18,15],"associated":[{"kind":1,"name":"Kima\\Model"}]},{"kind":1,"name":"App","modifiers":4096,"location":[19,5,19,19],"associated":[{"kind":1,"name":"Kima\\Prime\\App"}]},{"kind":1,"name":"InstanceModel","modifiers":4096,"location":[20,5,20,36],"associated":[{"kind":1,"name":"Model\\Instance"}]},{"kind":1,"name":"ObjectID","modifiers":4096,"location":[21,5,21,26],"associated":[{"kind":1,"name":"MongoDB\\BSON\\ObjectID"}]},{"kind":1,"name":"model\\Draft\\ADraft","modifiers":16,"location":[28,0,724,1],"associated":[{"kind":1,"name":"Kima\\Model"}],"description":"This is the base class for all the objects that want to have a draft\nversion of themselves, has the common operations as well as some guidelines\non how the child objects should behave","children":[{"kind":1024,"name":"ERROR_INVALID_FIELD_NAME","modifiers":1,"location":[33,10,33,68],"scope":"model\\Draft\\ADraft","value":"'Field name should be a string'"},{"kind":1024,"name":"ERROR_INVALID_USER_ID","modifiers":1,"location":[34,10,34,64],"scope":"model\\Draft\\ADraft","value":"'A user id should be provided'"},{"kind":1024,"name":"ERROR_INVALID_CONTENT","modifiers":1,"location":[35,10,35,78],"scope":"model\\Draft\\ADraft","value":"'Cannot populate a draft with a null object'"},{"kind":1024,"name":"DB_ENGINE","modifiers":1,"location":[39,10,39,29],"scope":"model\\Draft\\ADraft","value":"'mongo'"},{"kind":1024,"name":"TABLE","modifiers":1,"location":[43,10,43,33],"scope":"model\\Draft\\ADraft","value":"'draft.general'"},{"kind":1024,"name":"ID","modifiers":1,"location":[46,10,46,20],"scope":"model\\Draft\\ADraft","value":"'_id'"},{"kind":1024,"name":"ID_INSTANCE","modifiers":1,"location":[47,10,47,37],"scope":"model\\Draft\\ADraft","value":"'id_instance'"},{"kind":1024,"name":"MODULE","modifiers":1,"location":[48,10,48,27],"scope":"model\\Draft\\ADraft","value":"'module'"},{"kind":1024,"name":"ACTIVITY","modifiers":1,"location":[49,10,49,31],"scope":"model\\Draft\\ADraft","value":"'activity'"},{"kind":1024,"name":"CONTENT","modifiers":1,"location":[50,10,50,29],"scope":"model\\Draft\\ADraft","value":"'content'"},{"kind":1024,"name":"DATA","modifiers":1,"location":[51,10,51,23],"scope":"model\\Draft\\ADraft","value":"'data'"},{"kind":1024,"name":"LANG","modifiers":1,"location":[52,10,52,23],"scope":"model\\Draft\\ADraft","value":"'lang'"},{"kind":1024,"name":"ID_USER","modifiers":1,"location":[53,10,53,29],"scope":"model\\Draft\\ADraft","value":"'id_user'"},{"kind":1024,"name":"MODIFIED","modifiers":1,"location":[54,10,54,31],"scope":"model\\Draft\\ADraft","value":"'modified'"},{"kind":1024,"name":"MODIFIED_ON","modifiers":1,"location":[55,10,55,37],"scope":"model\\Draft\\ADraft","value":"'modified_on'"},{"kind":1024,"name":"STATUS","modifiers":1,"location":[56,10,56,27],"scope":"model\\Draft\\ADraft","value":"'status'"},{"kind":1024,"name":"VALUE","modifiers":1,"location":[57,10,57,25],"scope":"model\\Draft\\ADraft","value":"'value'"},{"kind":16,"name":"$_id","modifiers":1,"location":[63,11,63,15],"scope":"model\\Draft\\ADraft","type":"MongoDB\\BSON\\ObjectID;"},{"kind":16,"name":"$id_instance","modifiers":1,"location":[69,11,69,23],"scope":"model\\Draft\\ADraft","type":"model\\Draft\\Array"},{"kind":16,"name":"$date","modifiers":1,"location":[75,11,75,16],"scope":"model\\Draft\\ADraft","type":"DateTime"},{"kind":16,"name":"$content","modifiers":1,"location":[81,11,81,24],"scope":"model\\Draft\\ADraft","type":"array"},{"kind":16,"name":"$modified","modifiers":1,"location":[87,11,87,20],"scope":"model\\Draft\\ADraft","type":"bool"},{"kind":16,"name":"$status","modifiers":1,"location":[93,11,93,35],"scope":"model\\Draft\\ADraft","type":"int"},{"kind":16,"name":"$id_user","modifiers":1,"location":[99,11,99,19],"scope":"model\\Draft\\ADraft","type":"int"},{"kind":16,"name":"$activity","modifiers":1,"location":[105,11,105,20],"scope":"model\\Draft\\ADraft","type":"array"},{"kind":16,"name":"$source_module","modifiers":36,"location":[112,19,112,33],"scope":"model\\Draft\\ADraft","type":"string"},{"kind":32,"name":"get_by_id","modifiers":33,"location":[121,4,131,5],"description":"Retrieves a single instance of a draft and returns it","scope":"model\\Draft\\ADraft","type":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$id","location":[121,37,121,40],"description":"the id of the Draft\n","scope":"get_by_id","type":"string"}]},{"kind":32,"name":"exists","modifiers":33,"location":[140,4,154,5],"description":"Returns whether a draft exists in the database with the id passed","scope":"model\\Draft\\ADraft","type":"bool","children":[{"kind":128,"name":"$id","location":[140,34,140,37],"description":"the mongo id\n","scope":"exists","type":"string"}]},{"kind":32,"name":"update_by_field","modifiers":33,"location":[165,4,178,5],"description":"Updates a draft's content by setting the field.","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$id_user","location":[165,43,165,51],"scope":"update_by_field","type":"int"},{"kind":128,"name":"$_id","location":[165,53,165,57],"scope":"update_by_field","type":"string"},{"kind":128,"name":"$field","location":[165,59,165,65],"scope":"update_by_field","type":"string"},{"kind":128,"name":"$value","location":[165,67,165,73],"scope":"update_by_field","type":"mixed"},{"kind":128,"name":"$lang","location":[165,75,165,87],"scope":"update_by_field","value":"null","type":"string"}]},{"kind":32,"name":"save","modifiers":1,"location":[183,4,193,5],"description":"Save the draft","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$async","location":[183,25,183,39],"scope":"save","value":"false"}]},{"kind":32,"name":"update_by_common","modifiers":1,"location":[204,4,219,5],"description":"Saves the current draft data, it differs from the save() function above\nbecause it uses the common filters for saving instead of the overriden\nbehaviour that the child classes might implement.\n\nThis is useful, for example, to save by the real _id of the draft","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$async","location":[204,37,204,51],"description":"whether to save asynchronously","scope":"update_by_common","value":"false","type":"bool"},{"kind":128,"name":"$on_synchronization","location":[204,53,204,80],"scope":"update_by_common","value":"false"},{"kind":128,"name":"$flatten","location":[204,82,204,97],"scope":"update_by_common","value":"true"}]},{"kind":32,"name":"set_field","modifiers":1,"location":[228,4,248,5],"description":"Sets a field that is a saved as part of the content of the draft","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$field","location":[228,30,228,36],"description":"field name","scope":"set_field","type":"string"},{"kind":128,"name":"$data","location":[228,38,228,43],"description":"the field value","scope":"set_field","type":"mixed"},{"kind":128,"name":"$lang","location":[228,45,228,57],"scope":"set_field","value":"null"},{"kind":128,"name":"$updated","location":[228,59,228,75],"description":"whether the field has been user updated","scope":"set_field","value":"false","type":"bool"}]},{"kind":32,"name":"update_field","modifiers":1,"location":[262,4,269,5],"description":"Updates the value of a field and marks it as modified.\n\nImportant: the field names should be taken from the corresponding model,\ndo not declare constants that are duplicates of a model that has draft.","scope":"model\\Draft\\ADraft","type":"object","children":[{"kind":128,"name":"$field","location":[262,33,262,39],"description":"field name","scope":"update_field","type":"string"},{"kind":128,"name":"$data","location":[262,41,262,46],"description":"field value","scope":"update_field","type":"mixed"},{"kind":128,"name":"$lang","location":[262,48,262,58],"description":"lang prefix\n","scope":"update_field","value":"''","type":"string"}]},{"kind":32,"name":"get_field","modifiers":1,"location":[278,4,294,5],"description":"Returns a field from the draft's content","scope":"model\\Draft\\ADraft","type":"mixed","children":[{"kind":128,"name":"$field_name","location":[278,30,278,41],"description":"field name\n","scope":"get_field","type":"string"},{"kind":128,"name":"$lang","location":[278,43,278,53],"scope":"get_field","value":"''"}]},{"kind":32,"name":"populate","modifiers":1,"location":[304,4,331,5],"description":"Populates the content of this draft from the passed object","scope":"model\\Draft\\ADraft","type":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$session","location":[304,29,304,46],"scope":"populate","typeSource":1,"type":"Huli\\Authentication\\ISession"},{"kind":128,"name":"$content","location":[304,48,304,63],"description":"can be object or array","scope":"populate","value":"null","type":"mixed"},{"kind":128,"name":"$save","location":[304,65,304,77],"description":"whether to save the draft\n","scope":"populate","value":"true","type":"bool"}]},{"kind":32,"name":"synchronize_fields","modifiers":1,"location":[340,4,355,5],"description":"Synchronize a field with an existance draft","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$field_name","location":[340,39,340,50],"description":"field to synchronize","scope":"synchronize_fields","type":"string"},{"kind":128,"name":"$value","location":[340,52,340,58],"description":"value to be synchronized","scope":"synchronize_fields","type":"model\\Draft\\value"},{"kind":128,"name":"$multivalue_field","location":[340,60,340,84],"description":"multivalue fields to be syncrhonized","scope":"synchronize_fields","value":"null","type":"array"}]},{"kind":32,"name":"discard","modifiers":1,"location":[360,4,364,5],"description":"Discards the current draft","scope":"model\\Draft\\ADraft"},{"kind":32,"name":"mark_on_review","modifiers":1,"location":[369,4,373,5],"description":"Marks the current draft for review","scope":"model\\Draft\\ADraft"},{"kind":32,"name":"accept","modifiers":1,"location":[378,4,382,5],"description":"Marks the current draft as accepted","scope":"model\\Draft\\ADraft"},{"kind":32,"name":"get_by_field_single","modifiers":34,"location":[396,4,429,5],"description":"Retrieves one or more results filtering by the field name passed and that\nhave been modified before.","scope":"model\\Draft\\ADraft","type":"mixed","children":[{"kind":128,"name":"$id_instance","location":[397,8,397,20],"scope":"get_by_field_single","type":"int"},{"kind":128,"name":"$field","location":[398,8,398,14],"description":"field name","scope":"get_by_field_single","type":"string"},{"kind":128,"name":"$value","location":[399,8,399,14],"description":"the value to match the collections to","scope":"get_by_field_single","type":"mixed"},{"kind":128,"name":"$all","location":[400,8,400,20],"description":"whether to retrieve a single result or multiple results","scope":"get_by_field_single","value":"false","type":"bool"},{"kind":128,"name":"$modified_only","location":[401,8,401,30],"scope":"get_by_field_single","value":"false"},{"kind":128,"name":"$module","location":[402,8,402,22],"scope":"get_by_field_single","value":"null","type":"string"}]},{"kind":32,"name":"get_by_field_multiple_ids","modifiers":34,"location":[447,4,481,5],"description":"Retrieves multiple results based on the field name passed, the value param\ncotains an array of object that should have the same object property as\nthe field name.\ne.g. $field = 'bar'\n$values[0]->bar = \"foo\";","scope":"model\\Draft\\ADraft","type":"array","children":[{"kind":128,"name":"$id_instance","location":[448,8,448,20],"scope":"get_by_field_multiple_ids","type":"int"},{"kind":128,"name":"$field","location":[449,8,449,14],"description":"the field name","scope":"get_by_field_multiple_ids","type":"string"},{"kind":128,"name":"$values","location":[450,8,450,21],"description":"contains mixed object with at least a property named\nthat is the same as the $field parameter","scope":"get_by_field_multiple_ids","type":"array"},{"kind":128,"name":"$fields","location":[451,8,451,22],"scope":"get_by_field_multiple_ids","value":"null"},{"kind":128,"name":"$module","location":[452,8,452,22],"scope":"get_by_field_multiple_ids","value":"null","type":"string"}]},{"kind":32,"name":"get_module_filter","modifiers":34,"location":[488,4,493,5],"description":"Returns the filter that allows fetching by module","scope":"model\\Draft\\ADraft","type":"array"},{"kind":32,"name":"get_filters","modifiers":2,"location":[500,4,503,5],"description":"Returns the fields to be used as filters in the query","scope":"model\\Draft\\ADraft","type":"array"},{"kind":32,"name":"get_common_filters","modifiers":2,"location":[512,4,532,5],"description":"Returns this common filters used for queries","scope":"model\\Draft\\ADraft","type":"array","children":[{"kind":128,"name":"$include_extra_filters","location":[512,42,512,71],"scope":"get_common_filters","value":"true"}]},{"kind":32,"name":"get_fields","modifiers":2,"location":[542,4,586,5],"description":"Gets the fields to be set in the mongo query","scope":"model\\Draft\\ADraft","type":"array","children":[{"kind":128,"name":"$flatten","location":[542,34,542,50],"description":"[description]","scope":"get_fields","value":"false","type":"bool"},{"kind":128,"name":"$on_synchronization","location":[542,52,542,79],"description":"flag to indicate a synchronization operation\n","scope":"get_fields","value":"false","type":"bool"}]},{"kind":32,"name":"set_draft_fields","modifiers":2,"location":[594,4,609,5],"description":"Set the draft fields","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$field_name","location":[594,40,594,51],"description":"name of the field to be set","scope":"set_draft_fields","type":"string"},{"kind":128,"name":"$content_value","location":[594,53,594,67],"description":"value to be set","scope":"set_draft_fields","type":"object"}]},{"kind":32,"name":"prepare_value","modifiers":2,"location":[618,4,621,5],"description":"Modified a field so it has the right format for a draft","scope":"model\\Draft\\ADraft","type":"array","children":[{"kind":128,"name":"$value","location":[618,37,618,43],"description":"the value of the field\n","scope":"prepare_value","type":"mixed"}]},{"kind":32,"name":"flatten_content","modifiers":2,"location":[630,4,650,5],"description":"This function flattens the content of the draft. This is useful when\nupdating some fields inside the content as simple assigning a value\nto content would overwrite it.","scope":"model\\Draft\\ADraft","type":"array"},{"kind":32,"name":"review_field_on_data","modifiers":4,"location":[658,4,669,5],"description":"Review if a required field exist in a","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$field_name","location":[658,42,658,53],"description":"Draft field name to synchronize","scope":"review_field_on_data","type":"model\\Draft\\String"},{"kind":128,"name":"$field_to_sync","location":[658,55,658,69],"scope":"review_field_on_data"}]},{"kind":32,"name":"populate_array","modifiers":4,"location":[677,4,685,5],"description":"Populates the content of the draft with a field that contains an array of values","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$field_name","location":[677,36,677,47],"description":"the field name","scope":"populate_array","type":"string"},{"kind":128,"name":"$array","location":[677,49,677,61],"description":"contains the multiple values of a field","scope":"populate_array","type":"array"}]},{"kind":32,"name":"populate_l10n_array","modifiers":4,"location":[693,4,698,5],"description":"Populates the content of the draft with localized fields","scope":"model\\Draft\\ADraft","children":[{"kind":128,"name":"$field_name","location":[693,41,693,52],"description":"field name","scope":"populate_l10n_array","type":"string"},{"kind":128,"name":"$array","location":[693,54,693,66],"description":"the array that contains the localized variations of the value","scope":"populate_l10n_array","type":"array"}]},{"kind":32,"name":"save_status","modifiers":4,"location":[703,4,723,5],"description":"Saves the status of the current draft","scope":"model\\Draft\\ADraft"}]}]}}