{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/Webhooks/Mandrill/Inbound/Conversation/Process.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"Webhooks\\Mandrill\\Inbound\\Conversation","location":[11,0,11,49]},{"kind":1,"name":"DoctorConversation","modifiers":4096,"location":[13,5,13,49],"associated":[{"kind":1,"name":"HH\\Conversation\\Doctor"}]},{"kind":1,"name":"TResponse","modifiers":4096,"location":[14,5,14,22],"associated":[{"kind":1,"name":"HH\\Http\\TResponse"}]},{"kind":1,"name":"Logger","modifiers":4096,"location":[15,5,15,18],"associated":[{"kind":1,"name":"HH\\Log\\Logger"}]},{"kind":1,"name":"EventHandlingOperations","modifiers":4096,"location":[16,5,16,76],"associated":[{"kind":1,"name":"HH\\ServiceProviders\\EventHandling\\Operations"}]},{"kind":1,"name":"EventHandlingOrchestrator","modifiers":4096,"location":[17,5,17,80],"associated":[{"kind":1,"name":"HH\\ServiceProviders\\EventHandling\\Orchestrator"}]},{"kind":1,"name":"Cipher","modifiers":4096,"location":[18,5,18,19],"associated":[{"kind":1,"name":"HH\\Util\\Cipher"}]},{"kind":1,"name":"HuliCipher","modifiers":4096,"location":[19,5,19,35],"associated":[{"kind":1,"name":"Huli\\Util\\Cipher"}]},{"kind":1,"name":"Error","modifiers":4096,"location":[20,5,20,15],"associated":[{"kind":1,"name":"Kima\\Error"}]},{"kind":1,"name":"App","modifiers":4096,"location":[21,5,21,19],"associated":[{"kind":1,"name":"Kima\\Prime\\App"}]},{"kind":1,"name":"Parser","modifiers":4096,"location":[22,5,22,21],"associated":[{"kind":1,"name":"Mail\\Util\\Parser"}]},{"kind":1,"name":"Conversation","modifiers":4096,"location":[23,5,23,23],"associated":[{"kind":1,"name":"Model\\Conversation"}]},{"kind":1,"name":"Participant","modifiers":4096,"location":[24,5,24,35],"associated":[{"kind":1,"name":"Model\\Conversation\\Participant"}]},{"kind":1,"name":"Doctor","modifiers":4096,"location":[25,5,25,17],"associated":[{"kind":1,"name":"Model\\Doctor"}]},{"kind":1,"name":"stdClass","modifiers":4096,"location":[26,5,26,13],"associated":[{"kind":1,"name":"stdClass"}]},{"kind":1,"name":"IMandrill","modifiers":4096,"location":[27,5,27,32],"associated":[{"kind":1,"name":"Webhooks\\Mandrill\\IMandrill"}]},{"kind":1,"name":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","location":[29,0,377,1],"associated":[{"kind":2,"name":"Webhooks\\Mandrill\\IMandrill"},{"kind":4,"name":"HH\\Http\\TResponse"}],"description":"_\n_             _ _| |_\n| |           | |_   _|\n| |___  _   _ | | |_|\n| '_  \\| | | || | | |\n| | | || |_| || | | |\n|_| |_|\\___,_||_| |_|\n\n(c) Huli Inc","children":[{"kind":1024,"name":"ACCESS_KEY","modifiers":1,"location":[39,10,39,57],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'ba6svt90isjipvzfvxm0bz13a10mps06'"},{"kind":1024,"name":"IV","modifiers":1,"location":[40,10,40,29],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'Y+o3zccj0UA='"},{"kind":1024,"name":"NEW_IV","modifiers":1,"location":[41,10,41,45],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'o0RUaI878Hcw2zOoqQypAw=='"},{"kind":1024,"name":"ALIAS_ID_CONVERSATION","modifiers":1,"location":[46,10,46,37],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'c'"},{"kind":1024,"name":"ALIAS_ID_DOCTOR","modifiers":1,"location":[47,10,47,31],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'d'"},{"kind":1024,"name":"ERROR_PARSER","modifiers":1,"location":[52,10,52,50],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'Error parse the message'"},{"kind":1024,"name":"ERROR_IN_REPLY_TO","modifiers":1,"location":[57,10,57,69],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'The value In-Reply-To does not exists'"},{"kind":1024,"name":"ERROR_NOT_KEY_VALUE","modifiers":1,"location":[58,10,58,66],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'The value of key does not exists'"},{"kind":1024,"name":"ERROR_INVALID_KEYS","modifiers":1,"location":[59,10,59,55],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'Error, invalid keys %s'"},{"kind":1024,"name":"ERROR_INVALID_INFORMATION","modifiers":1,"location":[60,10,60,69],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'Error, invalid information %s'"},{"kind":1024,"name":"ERROR_PERMISSION","modifiers":1,"location":[61,10,61,84],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'User does not have permission in this conversation %s'"},{"kind":1024,"name":"ERROR_EMAIL_DOCTOR","modifiers":1,"location":[62,10,62,83],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'Error, different doctor email in db %s in email %s'"},{"kind":1024,"name":"ID_USER","modifiers":1,"location":[67,10,67,29],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'id_user'"},{"kind":1024,"name":"IN_REPLY_TO","modifiers":1,"location":[74,10,74,37],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'In-Reply-To'"},{"kind":1024,"name":"EMAIL_KEY_REGEX","modifiers":1,"location":[79,10,79,38],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","value":"'/(.*?)@/'"},{"kind":16,"name":"$id_doctor","modifiers":1,"location":[86,11,86,21],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"string"},{"kind":16,"name":"$key","modifiers":4,"location":[93,12,93,16],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"string"},{"kind":16,"name":"$conversation_info","modifiers":4,"location":[100,12,100,30],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"array"},{"kind":16,"name":"$email_obj","modifiers":4,"location":[107,12,107,22],"scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"object"},{"kind":32,"name":"get_reply_direction","modifiers":33,"location":[117,4,134,5],"description":"Gets the email direction to replay the message","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"string","children":[{"kind":128,"name":"$id_doctor","location":[117,47,117,57],"scope":"get_reply_direction","type":"int"},{"kind":128,"name":"$id_conversation","location":[117,59,117,75],"scope":"get_reply_direction","type":"int"}]},{"kind":32,"name":"get_access_key","modifiers":1,"location":[141,4,144,5],"description":"Returns the api access key","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"string"},{"kind":32,"name":"get_key_params","modifiers":1,"location":[151,4,154,5],"description":"Gets the params that go in the key","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"array"},{"kind":32,"name":"process_email","modifiers":1,"location":[161,4,196,5],"description":"Processes an email element","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","children":[{"kind":128,"name":"$email_obj","location":[161,34,161,53],"scope":"process_email","typeSource":1,"type":"stdClass"}]},{"kind":32,"name":"exist_in_reply_to","modifiers":1,"location":[203,4,210,5],"description":"Validates if the reply is a real reply","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","children":[{"kind":128,"name":"$email_obj","location":[203,38,203,57],"scope":"exist_in_reply_to","typeSource":1,"type":"stdClass"}]},{"kind":32,"name":"get_key_from_email","modifiers":1,"location":[219,4,230,5],"description":"Gets the value of the key extracting from the email","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","children":[{"kind":128,"name":"$email","location":[219,39,219,45],"scope":"get_key_from_email","type":"string"}]},{"kind":32,"name":"are_valid_keys","modifiers":1,"location":[240,4,249,5],"description":"Validates if the keys exists in the array","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"bool","children":[{"kind":128,"name":"$conv_info","location":[240,35,240,51],"scope":"are_valid_keys","type":"array"},{"kind":128,"name":"$keys","location":[240,53,240,64],"scope":"are_valid_keys","type":"array"}]},{"kind":32,"name":"tracking_use","modifiers":4,"location":[254,4,263,5],"description":"Tracking the use of this functionality","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process"},{"kind":32,"name":"save_message","modifiers":4,"location":[270,4,278,5],"description":"Saves the message text in the DB as if it were the normal flow","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","children":[{"kind":128,"name":"$msg","location":[270,34,270,38],"scope":"save_message","type":"string"}]},{"kind":32,"name":"send_error","modifiers":4,"location":[283,4,298,5],"description":"Sends an email to doctor when the process fails","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process"},{"kind":32,"name":"set_conversation_information","modifiers":4,"location":[305,4,332,5],"description":"Sets the conversation information","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process","type":"array"},{"kind":32,"name":"has_permission","modifiers":4,"location":[337,4,349,5],"description":"Validates if the doctor is a conversation participant","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process"},{"kind":32,"name":"validate_doctor_email","modifiers":4,"location":[354,4,365,5],"description":"Validates if the from email is equal to email that doctor has registered in DB","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process"},{"kind":32,"name":"validate_email_exist","modifiers":4,"location":[370,4,376,5],"description":"Validates if some doctor has this email associated with your account.","scope":"Webhooks\\Mandrill\\Inbound\\Conversation\\Process"}]}]}}