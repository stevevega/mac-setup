{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/HH/Subscription/Model/Wrapper.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"HH\\Subscription\\Model","location":[12,0,12,32]},{"kind":1,"name":"TResponse","modifiers":4096,"location":[14,5,14,22],"associated":[{"kind":1,"name":"HH\\Http\\TResponse"}]},{"kind":1,"name":"PlanModel","modifiers":4096,"location":[15,5,15,28],"associated":[{"kind":1,"name":"Model\\Plan"}]},{"kind":1,"name":"UserSubscriptionModel","modifiers":4096,"location":[16,5,16,53],"associated":[{"kind":1,"name":"Model\\User\\Subscription"}]},{"kind":1,"name":"stdClass","modifiers":4096,"location":[17,5,17,13],"associated":[{"kind":1,"name":"stdClass"}]},{"kind":1,"name":"HH\\Subscription\\Model\\Wrapper","modifiers":8,"location":[29,0,834,1],"associated":[{"kind":4,"name":"HH\\Http\\TResponse"}],"description":"Works as a container for subscription manipulations (setters)\nIt also keeps track of changes for validations before common actions\n\nCommon actions can be found at HH\\Subscription\\Model\\Actions\ncancellation, synchronizing, save a new record\n\nTry using UserSubscriptionModel for READ actions and this\nwrapper for WRITE actions over user subscription records","children":[{"kind":1024,"name":"DATA_TYPE","modifiers":1,"location":[36,10,36,33],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'data_type'"},{"kind":1024,"name":"DATA_TYPE_BOOLEAN","modifiers":1,"location":[37,10,37,39],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'boolean'"},{"kind":1024,"name":"DATA_TYPE_DATETIME","modifiers":1,"location":[38,10,38,41],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'datetime'"},{"kind":1024,"name":"DATA_TYPE_INTEGER","modifiers":1,"location":[39,10,39,39],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'integer'"},{"kind":1024,"name":"DATA_TYPE_STRING","modifiers":1,"location":[40,10,40,37],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'string'"},{"kind":1024,"name":"DEFAULT_VALUE","modifiers":1,"location":[41,10,41,41],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'default_value'"},{"kind":1024,"name":"NULLABLE","modifiers":1,"location":[42,10,42,31],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'nullable'"},{"kind":1024,"name":"FIELD","modifiers":1,"location":[43,10,43,25],"scope":"HH\\Subscription\\Model\\Wrapper","value":"'field'"},{"kind":16,"name":"$checks","modifiers":4,"location":[53,12,53,19],"scope":"HH\\Subscription\\Model\\Wrapper","type":"stdClass"},{"kind":16,"name":"$exists","modifiers":4,"location":[60,12,60,27],"scope":"HH\\Subscription\\Model\\Wrapper","type":"bool"},{"kind":16,"name":"$model_fields","modifiers":4,"location":[80,12,161,5],"scope":"HH\\Subscription\\Model\\Wrapper","type":"array"},{"kind":16,"name":"$sub","modifiers":4,"location":[168,12,168,16],"scope":"HH\\Subscription\\Model\\Wrapper","type":"Model\\User\\Subscription"},{"kind":32,"name":"__construct","modifiers":1,"location":[177,4,183,5],"description":"Constructor\n\nPreload current user subscription or defines an empty model for manipulations","scope":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_user","location":[177,32,177,51],"scope":"__construct","value":"null","typeSource":1,"type":"int"}]},{"kind":32,"name":"load_sub","modifiers":4,"location":[192,4,222,5],"description":"Retrieve latest active record for user","scope":"HH\\Subscription\\Model\\Wrapper","type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_user","location":[192,30,192,49],"scope":"load_sub","value":"null","typeSource":1,"type":"int"}]},{"kind":32,"name":"load_field","modifiers":4,"location":[234,4,263,5],"description":"Load a field to the wrapper mdel from a db retrieved model\nThis will handle nullable, default value and type transformation to the wrapper setters","scope":"HH\\Subscription\\Model\\Wrapper","type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$field","location":[234,32,234,38],"scope":"load_field","type":"string"},{"kind":128,"name":"$value","location":[234,40,234,46],"scope":"load_field","type":"HH\\Subscription\\Model\\any"},{"kind":128,"name":"$field_definition","location":[234,48,234,65],"scope":"load_field","type":"array"}]},{"kind":32,"name":"get_model","modifiers":1,"location":[273,4,276,5],"description":"Inner model getter\n\nAdvise: avoid using this method (accessing the inner model) because all\nthe model updates should be done safely through this wrapper","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"Model\\User\\Subscription"},{"kind":32,"name":"exists","modifiers":1,"location":[283,4,286,5],"description":"Detects if wrapped subscription was found at db or created as an empty model","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"bool"},{"kind":32,"name":"was_field_set","modifiers":1,"location":[295,4,298,5],"description":"Detect if a field setter was called","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"bool","children":[{"kind":128,"name":"$field_name","location":[295,34,295,52],"scope":"was_field_set","typeSource":1,"type":"string"}]},{"kind":32,"name":"is_free_plan","modifiers":1,"location":[310,4,313,5],"description":"Detect if plan is free based on metadata field\n\nBy default it returns false (not free), this is because\nmost side effects are done on free plan assignments","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"bool"},{"kind":32,"name":"is_processed_manually","modifiers":1,"location":[320,4,323,5],"description":"Detect if subscription is mark as processed manually","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"bool"},{"kind":32,"name":"has_customer","modifiers":1,"location":[330,4,333,5],"description":"Detect if subscription has a payment processor customer associated","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"bool"},{"kind":32,"name":"activate","modifiers":1,"location":[340,4,345,5],"description":"Mark in-memory subscription as active","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper"},{"kind":32,"name":"deactivate","modifiers":1,"location":[352,4,357,5],"description":"Mark in-memory subscription as inactive","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper"},{"kind":32,"name":"discard_trial","modifiers":1,"location":[364,4,369,5],"description":"Unset trial information","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper"},{"kind":32,"name":"set_active_until","modifiers":1,"location":[378,4,384,5],"description":"Set active_until field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$active_until","location":[378,37,378,64],"scope":"set_active_until","value":"null","typeSource":1,"type":"string"}]},{"kind":32,"name":"set_allow_contact","modifiers":1,"location":[393,4,399,5],"description":"Set allow_contact field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$allow_contact","location":[393,38,393,64],"scope":"set_allow_contact","value":"null","typeSource":1,"type":"bool"}]},{"kind":32,"name":"set_cancellation_reason_key","modifiers":4,"location":[409,4,421,5],"description":"Set cancellation_reason_key field\nSide effect: when a value is set, then mark the subscription as inactive","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$cancellation_reason_key","location":[409,49,409,87],"scope":"set_cancellation_reason_key","value":"null","typeSource":1,"type":"string"}]},{"kind":32,"name":"set_cancellation_reason_text","modifiers":4,"location":[431,4,443,5],"description":"Set cancellation_reason_text field\nSide effect: when a value is set, then mark the subscription as inactive","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$cancellation_reason_text","location":[431,50,431,89],"scope":"set_cancellation_reason_text","value":"null","typeSource":1,"type":"string"}]},{"kind":32,"name":"set_has_card","modifiers":1,"location":[452,4,458,5],"description":"Set has_card field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$has_card","location":[452,33,452,54],"scope":"set_has_card","value":"null","typeSource":1,"type":"bool"}]},{"kind":32,"name":"set_id_plan","modifiers":4,"location":[468,4,478,5],"description":"Set id_plan field\nSide effect: if plan set is free, then discard the trial (no trial)","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_plan","location":[468,33,468,45],"scope":"set_id_plan","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_id_stripe_customer","modifiers":1,"location":[492,4,503,5],"description":"Set id_stripe_customer field\n\nSide effect: if customer is cleanup (null), then discard\nknowning has_card and discard trial (no trial)","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_stripe_customer","location":[492,43,492,76],"scope":"set_id_stripe_customer","value":"null","typeSource":1,"type":"string"}]},{"kind":32,"name":"set_id_user","modifiers":1,"location":[512,4,518,5],"description":"Set id_user field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_user","location":[512,32,512,44],"scope":"set_id_user","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_id_user_subscription","modifiers":1,"location":[527,4,533,5],"description":"Set id_user_subscription field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_user_subscription","location":[527,45,527,77],"scope":"set_id_user_subscription","value":"null","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_is_processed_manually","modifiers":1,"location":[542,4,548,5],"description":"Set is_processed_manually field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$is_processed_manually","location":[542,46,542,80],"scope":"set_is_processed_manually","value":"null","typeSource":1,"type":"bool"}]},{"kind":32,"name":"set_id_user_modified_by","modifiers":1,"location":[557,4,563,5],"description":"Set id_user_modified_by field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_user_modified_by","location":[557,44,557,68],"scope":"set_id_user_modified_by","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_price","modifiers":4,"location":[572,4,580,5],"description":"Set price field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$price","location":[572,31,572,48],"description":"(default : 0)\n","scope":"set_price","value":"null","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_status","modifiers":1,"location":[592,4,598,5],"description":"Set active field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$status","location":[592,31,592,42],"scope":"set_status","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_trial_end_on","modifiers":4,"location":[607,4,613,5],"description":"Set trial_end_on field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$trial_end_on","location":[607,38,607,65],"scope":"set_trial_end_on","value":"null","typeSource":1,"type":"string"}]},{"kind":32,"name":"set_trial_grace_hours","modifiers":4,"location":[622,4,630,5],"description":"Set trial_grace_hours field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$trial_grace_hours","location":[622,43,622,72],"description":"(default : 0)\n","scope":"set_trial_grace_hours","value":"null","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_is_free","modifiers":4,"location":[639,4,645,5],"description":"Set is_free field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$is_free","location":[639,33,639,46],"scope":"set_is_free","typeSource":1,"type":"bool"}]},{"kind":32,"name":"set_trial_length","modifiers":4,"location":[654,4,660,5],"description":"Set trial_length field","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$trial_length","location":[654,38,654,62],"description":"(default : 0)\n","scope":"set_trial_length","value":"null","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_plan","modifiers":1,"location":[670,4,676,5],"description":"Quick setter for plan data : id and price","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_plan","location":[670,29,670,41],"scope":"set_plan","typeSource":1,"type":"int"},{"kind":128,"name":"$price","location":[670,43,670,53],"description":"(default : 0)\n","scope":"set_plan","typeSource":1,"type":"int"}]},{"kind":32,"name":"set_reason","modifiers":1,"location":[686,4,694,5],"description":"Quick setter for cancellation reason data : key and text","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$reason_key","location":[687,8,687,33],"scope":"set_reason","value":"null","typeSource":1,"type":"string"},{"kind":128,"name":"$reason_text","location":[688,8,688,34],"scope":"set_reason","value":"null","typeSource":1,"type":"string"}]},{"kind":32,"name":"set_subscription","modifiers":1,"location":[704,4,712,5],"description":"Quick setter for subscription data : customer and manually processed","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$id_stripe_customer","location":[705,8,705,41],"scope":"set_subscription","value":"null","typeSource":1,"type":"string"},{"kind":128,"name":"$is_processed_manually","location":[706,8,706,42],"scope":"set_subscription","value":"null","typeSource":1,"type":"bool"}]},{"kind":32,"name":"set_trial","modifiers":1,"location":[723,4,733,5],"description":"Quick setter for trial data : end datetime, length and grace hours","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$trial_end_on","location":[724,8,724,35],"scope":"set_trial","value":"null","typeSource":1,"type":"string"},{"kind":128,"name":"$trial_length","location":[725,8,725,32],"description":"(default : 0)","scope":"set_trial","value":"null","typeSource":1,"type":"int"},{"kind":128,"name":"$trial_grace_hours","location":[726,8,726,37],"description":"(default : 0)\n","scope":"set_trial","value":"null","typeSource":1,"type":"int"}]},{"kind":32,"name":"get_active_until","modifiers":1,"location":[740,4,743,5],"description":"Get active_until","scope":"HH\\Subscription\\Model\\Wrapper","type":"HH\\Subscription\\Model\\datetime"},{"kind":32,"name":"get_allow_contact","modifiers":1,"location":[750,4,753,5],"description":"Get allow_contact","scope":"HH\\Subscription\\Model\\Wrapper","type":"bool|null"},{"kind":32,"name":"get_has_card","modifiers":1,"location":[760,4,763,5],"description":"Get has_card","scope":"HH\\Subscription\\Model\\Wrapper","type":"bool|null"},{"kind":32,"name":"get_id","modifiers":1,"location":[770,4,773,5],"description":"Get id_user_subscription","scope":"HH\\Subscription\\Model\\Wrapper","type":"int|null"},{"kind":32,"name":"get_customer","modifiers":1,"location":[780,4,783,5],"description":"Get customer information","scope":"HH\\Subscription\\Model\\Wrapper","type":"string|null"},{"kind":32,"name":"get_plan","modifiers":1,"location":[791,4,796,5],"description":"Get plan information","scope":"HH\\Subscription\\Model\\Wrapper","type":"array"},{"kind":32,"name":"get_subscription","modifiers":1,"location":[804,4,809,5],"description":"Get subscription information","scope":"HH\\Subscription\\Model\\Wrapper","type":"array"},{"kind":32,"name":"get_trial","modifiers":1,"location":[818,4,823,5],"description":"Get trial information","scope":"HH\\Subscription\\Model\\Wrapper","type":"array"},{"kind":32,"name":"get_user","modifiers":1,"location":[830,4,833,5],"description":"Get id_user","scope":"HH\\Subscription\\Model\\Wrapper","typeSource":1,"type":"int"}]}]}}