{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/HH/Request/Handler/Billing/Source/Card/Create.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"HH\\Request\\Handler\\Billing\\Source\\Card","location":[11,0,11,49]},{"kind":1,"name":"ICommunication","modifiers":4096,"location":[13,5,13,33],"associated":[{"kind":1,"name":"Communication\\ICommunication"}]},{"kind":1,"name":"TCommunication","modifiers":4096,"location":[14,5,14,33],"associated":[{"kind":1,"name":"Communication\\TCommunication"}]},{"kind":1,"name":"AAlter","modifiers":4096,"location":[15,5,15,31],"associated":[{"kind":1,"name":"HH\\Request\\Behavior\\AAlter"}]},{"kind":1,"name":"Option","modifiers":4096,"location":[16,5,16,28],"associated":[{"kind":1,"name":"HH\\Request\\Field\\Option"}]},{"kind":1,"name":"ChangePlanFlow","modifiers":4096,"location":[17,5,17,54],"associated":[{"kind":1,"name":"HH\\Subscription\\Flow\\ChangePlan"}]},{"kind":1,"name":"SubscriptionCancel","modifiers":4096,"location":[18,5,18,63],"associated":[{"kind":1,"name":"HH\\Subscription\\Model\\Actions\\Cancel"}]},{"kind":1,"name":"SubscriptionSave","modifiers":4096,"location":[19,5,19,59],"associated":[{"kind":1,"name":"HH\\Subscription\\Model\\Actions\\Save"}]},{"kind":1,"name":"SubscriptionSync","modifiers":4096,"location":[20,5,20,66],"associated":[{"kind":1,"name":"HH\\Subscription\\Model\\Actions\\Synchronize"}]},{"kind":1,"name":"SubscriptionWrapper","modifiers":4096,"location":[21,5,21,57],"associated":[{"kind":1,"name":"HH\\Subscription\\Model\\Wrapper"}]},{"kind":1,"name":"PlanModel","modifiers":4096,"location":[22,5,22,28],"associated":[{"kind":1,"name":"Model\\Plan"}]},{"kind":1,"name":"UserModel","modifiers":4096,"location":[23,5,23,28],"associated":[{"kind":1,"name":"Model\\User"}]},{"kind":1,"name":"UserSubscriptionModel","modifiers":4096,"location":[24,5,24,53],"associated":[{"kind":1,"name":"Model\\User\\Subscription"}]},{"kind":1,"name":"Customer","modifiers":4096,"location":[25,5,25,21],"associated":[{"kind":1,"name":"Payment\\Customer"}]},{"kind":1,"name":"IProcessor","modifiers":4096,"location":[26,5,26,23],"associated":[{"kind":1,"name":"Payment\\IProcessor"}]},{"kind":1,"name":"PaymentProcessor","modifiers":4096,"location":[27,5,27,29],"associated":[{"kind":1,"name":"Payment\\PaymentProcessor"}]},{"kind":1,"name":"stdClass","modifiers":4096,"location":[28,5,28,13],"associated":[{"kind":1,"name":"stdClass"}]},{"kind":1,"name":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","modifiers":8,"location":[33,0,511,1],"associated":[{"kind":1,"name":"HH\\Request\\Behavior\\AAlter"},{"kind":2,"name":"Communication\\ICommunication"},{"kind":4,"name":"Communication\\TCommunication"}],"description":"Billing source SAVE request class","children":[{"kind":1024,"name":"COMM_HANDLER","modifiers":1,"location":[37,10,37,39],"scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","value":"'comm_handler'"},{"kind":1024,"name":"PROMO_CODE","modifiers":1,"location":[38,10,38,30],"scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","value":"'promo'"},{"kind":16,"name":"$token","modifiers":2,"location":[46,14,46,20],"scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"string"},{"kind":16,"name":"$is_default_card","modifiers":2,"location":[53,14,53,30],"scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"bool"},{"kind":16,"name":"$promo","modifiers":2,"location":[60,14,60,20],"scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create"},{"kind":16,"name":"$subscription","modifiers":4,"location":[67,12,67,25],"scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"Model\\User\\Subscription"},{"kind":16,"name":"$flow","modifiers":4,"location":[74,12,74,17],"scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"HH\\Subscription\\Flow\\ChangePlan"},{"kind":32,"name":"get_request_fields","modifiers":1,"location":[81,4,91,5],"description":"Fields required for save/update","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create"},{"kind":32,"name":"get_children_requests","modifiers":1,"location":[98,4,101,5],"description":"No children requests","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create"},{"kind":32,"name":"set_promo","modifiers":1,"location":[108,4,118,5],"description":"Sets and validates the promo code","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$promo","location":[108,30,108,43],"scope":"set_promo","typeSource":1,"type":"string"}]},{"kind":32,"name":"include_last_insert_id","modifiers":2,"location":[126,4,129,5],"description":"Sets whether or not to retrive the last insert id and include it\nin the processed data","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"bool"},{"kind":32,"name":"get_primary_key","modifiers":2,"location":[136,4,138,5],"description":"Gets the primary used for the last insert id retrieval","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"int"},{"kind":32,"name":"alter","modifiers":2,"location":[145,4,162,5],"description":"Saves the patient file","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"bool"},{"kind":32,"name":"trigger_events","modifiers":2,"location":[169,4,184,5],"description":"Triggers events happening on success request","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create"},{"kind":32,"name":"set_is_default_card","modifiers":2,"location":[193,4,198,5],"description":"Set the is_default_card and validates them","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$is_default_card","location":[193,43,193,59],"scope":"set_is_default_card","type":"bool"}]},{"kind":32,"name":"load_user_subscription","modifiers":4,"location":[205,4,215,5],"description":"Retrieves the subscription information stored through \\User\\Subscription","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create"},{"kind":32,"name":"create_subscription","modifiers":4,"location":[225,4,268,5],"description":"When the user doesn't have a subscription, then one is created and the user\nsubscription is migrated to the payment processor flows","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$processor","location":[225,41,225,62],"scope":"create_subscription","typeSource":1,"type":"Payment\\IProcessor"}]},{"kind":32,"name":"create_user_new_subscription","modifiers":4,"location":[277,4,291,5],"description":"Create new user subscription and wrap it for handling","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Subscription\\Model\\Wrapper","children":[{"kind":128,"name":"$customer","location":[277,50,277,59],"scope":"create_user_new_subscription","type":"mixed"}]},{"kind":32,"name":"cancel_user_current_subscription","modifiers":4,"location":[300,4,318,5],"description":"Cancel current user subscription","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create"},{"kind":32,"name":"save_user_new_subscription","modifiers":4,"location":[329,4,347,5],"description":"Defines a new subscription record for the user","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$customer","location":[329,48,329,57],"scope":"save_user_new_subscription","type":"Payment\\Customer"}]},{"kind":32,"name":"change_user_subscription","modifiers":4,"location":[356,4,378,5],"description":"Change user subscription via change plan flow","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$customer","location":[356,46,356,55],"scope":"change_user_subscription","type":"Payment\\Customer"}]},{"kind":32,"name":"review_cards","modifiers":4,"location":[387,4,407,5],"description":"Checks for duplicate cards in the user account","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$processor","location":[387,34,387,55],"scope":"review_cards","typeSource":1,"type":"Payment\\IProcessor"}]},{"kind":32,"name":"add_customer_card","modifiers":4,"location":[416,4,434,5],"description":"Adds customer card at payment processor","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$processor","location":[416,39,416,60],"scope":"add_customer_card","typeSource":1,"type":"Payment\\IProcessor"}]},{"kind":32,"name":"process_default_card","modifiers":4,"location":[443,4,458,5],"description":"Process the customer default card (the one that will be charged first)","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$processor","location":[443,42,443,63],"scope":"process_default_card","typeSource":1,"type":"Payment\\IProcessor"}]},{"kind":32,"name":"get_default_card","modifiers":4,"location":[467,4,485,5],"description":"Retrieve customer default card","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","type":"Stripe\\Card|null","children":[{"kind":128,"name":"$processor","location":[467,38,467,59],"scope":"get_default_card","typeSource":1,"type":"Payment\\IProcessor"}]},{"kind":32,"name":"set_default_card","modifiers":4,"location":[494,4,510,5],"description":"Sets the customer default card","scope":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","typeSource":1,"type":"HH\\Request\\Handler\\Billing\\Source\\Card\\Create","children":[{"kind":128,"name":"$processor","location":[494,38,494,59],"scope":"set_default_card","typeSource":1,"type":"Payment\\IProcessor"}]}]}]}}