{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/HH/Mail/Handler/Appointment/Base.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"HH\\Mail\\Handler\\Appointment","location":[11,0,11,38]},{"kind":1,"name":"AppointmentSource","modifiers":4096,"location":[13,5,13,62],"associated":[{"kind":1,"name":"HH\\Calendar\\Event\\Appointment\\Source"}]},{"kind":1,"name":"AppointmentStatus","modifiers":4096,"location":[14,5,14,62],"associated":[{"kind":1,"name":"HH\\Calendar\\Event\\Appointment\\Status"}]},{"kind":1,"name":"HHClinic","modifiers":4096,"location":[15,5,15,26],"associated":[{"kind":1,"name":"HH\\Clinic"}]},{"kind":1,"name":"ClinicNavigator","modifiers":4096,"location":[16,5,16,54],"associated":[{"kind":1,"name":"HH\\Clinic\\Navigation\\Navigator"}]},{"kind":1,"name":"HHDoctor","modifiers":4096,"location":[17,5,17,26],"associated":[{"kind":1,"name":"HH\\Doctor"}]},{"kind":1,"name":"EntityClinic","modifiers":4096,"location":[18,5,18,37],"associated":[{"kind":1,"name":"HH\\Entity\\Clinic"}]},{"kind":1,"name":"Instance","modifiers":4096,"location":[19,5,19,16],"associated":[{"kind":1,"name":"HH\\Instance"}]},{"kind":1,"name":"MailHandler","modifiers":4096,"location":[20,5,20,24],"associated":[{"kind":1,"name":"HH\\Mail\\MailHandler"}]},{"kind":1,"name":"Template","modifiers":4096,"location":[21,5,21,26],"associated":[{"kind":1,"name":"HH\\Mail\\Util\\Template"}]},{"kind":1,"name":"Module","modifiers":4096,"location":[22,5,22,14],"associated":[{"kind":1,"name":"HH\\Module"}]},{"kind":1,"name":"TreatmentModel","modifiers":4096,"location":[23,5,23,35],"associated":[{"kind":1,"name":"HH\\Treatment"}]},{"kind":1,"name":"ADoctor","modifiers":4096,"location":[24,5,24,18],"associated":[{"kind":1,"name":"HH\\UI\\ADoctor"}]},{"kind":1,"name":"CalendarEvent","modifiers":4096,"location":[25,5,25,34],"associated":[{"kind":1,"name":"HH\\UI\\Component\\CalendarEvent"}]},{"kind":1,"name":"Map","modifiers":4096,"location":[26,5,26,14],"associated":[{"kind":1,"name":"HH\\UI\\Map"}]},{"kind":1,"name":"Date","modifiers":4096,"location":[27,5,27,17],"associated":[{"kind":1,"name":"HH\\Util\\Date"}]},{"kind":1,"name":"Http","modifiers":4096,"location":[28,5,28,17],"associated":[{"kind":1,"name":"HH\\Util\\Http"}]},{"kind":1,"name":"PublicAwsThumbnail","modifiers":4096,"location":[29,5,29,61],"associated":[{"kind":1,"name":"Huli\\AWS\\Thumbnail\\PublicThumbnail"}]},{"kind":1,"name":"AwsThumbnailSize","modifiers":4096,"location":[30,5,30,48],"associated":[{"kind":1,"name":"Huli\\AWS\\Thumbnail\\Size"}]},{"kind":1,"name":"InstancePhoto","modifiers":4096,"location":[31,5,31,63],"associated":[{"kind":1,"name":"Huli\\Entity\\Doctor\\Profile\\Instance\\Photo"}]},{"kind":1,"name":"Gender","modifiers":4096,"location":[32,5,32,30],"associated":[{"kind":1,"name":"Huli\\Enum\\Listable\\Gender"}]},{"kind":1,"name":"InstanceSetting","modifiers":4096,"location":[33,5,33,54],"associated":[{"kind":1,"name":"Huli\\Enum\\Set\\Instance\\Setting"}]},{"kind":1,"name":"L10n","modifiers":4096,"location":[34,5,34,14],"associated":[{"kind":1,"name":"Kima\\L10n"}]},{"kind":1,"name":"MailProvider","modifiers":4096,"location":[35,5,35,34],"associated":[{"kind":1,"name":"Mail\\Provider"}]},{"kind":1,"name":"AppointmentModel","modifiers":4096,"location":[36,5,36,42],"associated":[{"kind":1,"name":"Model\\Appointment"}]},{"kind":1,"name":"AuthorizationModel","modifiers":4096,"location":[37,5,37,46],"associated":[{"kind":1,"name":"Model\\Authorization"}]},{"kind":1,"name":"CalendarModel","modifiers":4096,"location":[38,5,38,36],"associated":[{"kind":1,"name":"Model\\Calendar"}]},{"kind":1,"name":"ClinicInstanceModel","modifiers":4096,"location":[39,5,39,49],"associated":[{"kind":1,"name":"Model\\Clinic\\Instance"}]},{"kind":1,"name":"DoctorModel","modifiers":4096,"location":[40,5,40,32],"associated":[{"kind":1,"name":"Model\\Doctor"}]},{"kind":1,"name":"DoctorPhoneModel","modifiers":4096,"location":[41,5,41,43],"associated":[{"kind":1,"name":"Model\\Doctor\\Phone"}]},{"kind":1,"name":"InstanceSettingModel","modifiers":4096,"location":[42,5,42,51],"associated":[{"kind":1,"name":"Model\\Instance\\Setting"}]},{"kind":1,"name":"CountryModel","modifiers":4096,"location":[43,5,43,43],"associated":[{"kind":1,"name":"Model\\Location\\Country"}]},{"kind":1,"name":"PatientModel","modifiers":4096,"location":[44,5,44,34],"associated":[{"kind":1,"name":"Model\\Patient"}]},{"kind":1,"name":"PatientIcePersonModel","modifiers":4096,"location":[45,5,45,54],"associated":[{"kind":1,"name":"Model\\Patient\\Ice\\Person"}]},{"kind":1,"name":"PatientFileModel","modifiers":4096,"location":[46,5,46,43],"associated":[{"kind":1,"name":"Model\\Patient\\File"}]},{"kind":1,"name":"PatientPhoneModel","modifiers":4096,"location":[47,5,47,45],"associated":[{"kind":1,"name":"Model\\Patient\\Phone"}]},{"kind":1,"name":"HH\\Mail\\Handler\\Appointment\\Base","modifiers":16,"location":[49,0,746,1],"associated":[{"kind":1,"name":"HH\\Mail\\MailHandler"}],"description":"_\n_             _ _| |_\n| |           | |_   _|\n| |___  _   _ | | |_|\n| '_  \\| | | || | | |\n| | | || |_| || | | |\n|_| |_|\\___,_||_| |_|\n\n(c) Huli Inc","children":[{"kind":1024,"name":"MAP_WIDTH","modifiers":1,"location":[51,10,51,25],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"540"},{"kind":1024,"name":"MAP_HEIGHT","modifiers":1,"location":[52,10,52,26],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"200"},{"kind":1024,"name":"TAG_HULIHEALTH","modifiers":1,"location":[54,10,54,39],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'hulihealth'"},{"kind":1024,"name":"TAG_HULIPRACTICE","modifiers":1,"location":[55,10,55,43],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'hulipractice'"},{"kind":1024,"name":"TAG_HULISEARCH","modifiers":1,"location":[56,10,56,39],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'hulisearch'"},{"kind":1024,"name":"ERROR_INVALID_EVENT","modifiers":1,"location":[61,10,61,55],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'invalid_id_event [%s]'"},{"kind":1024,"name":"ERROR_INVALID_PATIENT","modifiers":1,"location":[62,10,62,56],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'invalid_patient_[%s]'"},{"kind":1024,"name":"ERROR_INVALID_DOCTOR","modifiers":1,"location":[63,10,63,54],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'invalid_doctor_[%s]'"},{"kind":1024,"name":"ERROR_INVALID_CALENDAR","modifiers":1,"location":[64,10,64,58],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'invalid_calendar_[%s]'"},{"kind":1024,"name":"R_ID_EVENT","modifiers":1,"location":[69,10,69,28],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'eid'"},{"kind":1024,"name":"R_ID_EVENT_OLD","modifiers":1,"location":[70,10,70,33],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'eido'"},{"kind":1024,"name":"ID_EVENT","modifiers":1,"location":[75,10,75,31],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'id_event'"},{"kind":1024,"name":"ID_EVENT_OLD","modifiers":1,"location":[76,10,76,39],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'id_event_old'"},{"kind":1024,"name":"HULIHEALTH_APPOINTMENT_LINK","modifiers":1,"location":[81,10,81,55],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'/appointments'"},{"kind":1024,"name":"PRACTICE_APPOINTMENT_LINK","modifiers":1,"location":[82,10,82,50],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'/#calendar'"},{"kind":1024,"name":"ID_PHR","modifiers":1,"location":[89,10,89,20],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"2"},{"kind":1024,"name":"UNKNOWN_PATIENT","modifiers":1,"location":[90,10,90,45],"scope":"HH\\Mail\\Handler\\Appointment\\Base","value":"'unknown_patient'"},{"kind":16,"name":"$appt","modifiers":2,"location":[97,14,97,19],"scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"HH\\Mail\\Handler\\Appointment\\Appointment"},{"kind":16,"name":"$orig_appt","modifiers":2,"location":[104,14,104,31],"scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"HH\\Mail\\Handler\\Appointment\\Appointment"},{"kind":16,"name":"$doctor","modifiers":2,"location":[111,14,111,21],"scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"HH\\Mail\\Handler\\Appointment\\Doctor"},{"kind":16,"name":"$patient","modifiers":2,"location":[118,14,118,22],"scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"HH\\Mail\\Handler\\Appointment\\Patient"},{"kind":16,"name":"$calendar","modifiers":2,"location":[125,14,125,23],"scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"HH\\Mail\\Handler\\Appointment\\Calendar"},{"kind":32,"name":"render_custom_views","modifiers":1,"location":[132,4,141,5],"description":"Render custom view","scope":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"render_clinic_map","modifiers":1,"location":[151,4,174,5],"description":"Render clinic navigation","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$clinic","location":[151,38,151,45],"scope":"render_clinic_map","type":"mixed"},{"kind":128,"name":"$include_map","location":[151,47,151,67],"scope":"render_clinic_map","value":"false","type":"mixed"}]},{"kind":32,"name":"render_clinic_navigation","modifiers":1,"location":[183,4,221,5],"description":"Render clinic navigation","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$clinic","location":[183,45,183,52],"scope":"render_clinic_navigation","type":"mixed"}]},{"kind":32,"name":"load_appointment","modifiers":2,"location":[226,4,237,5],"description":"Loads the appointment data","scope":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"load_original_appointment","modifiers":2,"location":[242,4,249,5],"description":"Loads the old appointment data if present","scope":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"load_doctor","modifiers":2,"location":[254,4,269,5],"description":"Loads the doctor data, needs an appointment to be loaded beforehand","scope":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"load_calendar_settings","modifiers":2,"location":[274,4,286,5],"description":"Loads the doctor calendar settings, needs a doctor to be loaded beforehand","scope":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"load_assistants","modifiers":2,"location":[291,4,302,5],"description":"Loads the assistants that need to be notified for this clinic","scope":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"load_patient","modifiers":2,"location":[307,4,338,5],"description":"Loads the patient information","scope":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"load_patient_alternative_contacts","modifiers":2,"location":[345,4,353,5],"description":"Loads the patient alternative contacts that will be notified","scope":"HH\\Mail\\Handler\\Appointment\\Base","typeSource":1,"type":"HH\\Mail\\Handler\\Appointment\\Base"},{"kind":32,"name":"check_patient_has_enabled_notifications","modifiers":2,"location":[361,4,366,5],"description":"Checks if the patient has the send notifications flag enabled or\nhas some alternative contacts to be notified","scope":"HH\\Mail\\Handler\\Appointment\\Base","typeSource":1,"type":"bool"},{"kind":32,"name":"add_contacts_recipients","modifiers":2,"location":[376,4,387,5],"description":"Adds the email recipients, they could be the main email contact of the patient\nor the emergency contacts that has enabled the send notifications flag","scope":"HH\\Mail\\Handler\\Appointment\\Base","typeSource":1,"type":"HH\\Mail\\Handler\\Appointment\\void","children":[{"kind":128,"name":"$mail_provider","location":[376,47,376,74],"scope":"add_contacts_recipients","typeSource":1,"type":"Mail\\Provider"}]},{"kind":32,"name":"get_doctor_profile","modifiers":2,"location":[396,4,403,5],"description":"Retrieve the doctor profile data by language","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"HH\\Doctor","children":[{"kind":128,"name":"$id_language","location":[396,42,396,54],"scope":"get_doctor_profile","type":"int"}]},{"kind":32,"name":"get_clinic_profile","modifiers":2,"location":[413,4,421,5],"description":"Retrieve the clinic profile data by language","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"HH\\Clinic","children":[{"kind":128,"name":"$id_language","location":[413,42,413,54],"scope":"get_clinic_profile","type":"mixed"}]},{"kind":32,"name":"has_account","modifiers":2,"location":[430,4,433,5],"description":"Returns whether the patient has account with Huli or not","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"bool","children":[{"kind":128,"name":"$patient","location":[430,35,430,43],"scope":"has_account","type":"Patient|Patient\\File"}]},{"kind":32,"name":"is_hh_branded","modifiers":2,"location":[440,4,444,5],"description":"Return whether the emails should be sent as a HuliHealth branded email","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"bool"},{"kind":32,"name":"add_common_params","modifiers":2,"location":[452,4,470,5],"description":"Appends commmon template params","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[452,41,452,49],"scope":"add_common_params","type":"HH\\Mail\\Handler\\Appointment\\arrayy"},{"kind":128,"name":"$profile","location":[452,51,452,59],"description":"doctor profile data","scope":"add_common_params","type":"HH\\Doctor"}]},{"kind":32,"name":"add_doctor_photo","modifiers":2,"location":[478,4,507,5],"description":"Apppends the doctor photo","scope":"HH\\Mail\\Handler\\Appointment\\Base","typeSource":1,"type":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[478,40,478,54],"scope":"add_doctor_photo","type":"array"},{"kind":128,"name":"$profile","location":[478,56,478,64],"description":"doctor profile data","scope":"add_doctor_photo","type":"HH\\Doctor"}]},{"kind":32,"name":"add_clinic_params","modifiers":2,"location":[518,4,550,5],"description":"Appends clinic profile data to template params","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[518,41,518,49],"scope":"add_clinic_params","type":"array"},{"kind":128,"name":"$clinic","location":[518,51,518,58],"scope":"add_clinic_params","type":"HH\\Clinic"},{"kind":128,"name":"$id_language","location":[518,60,518,72],"scope":"add_clinic_params","type":"mixed"},{"kind":128,"name":"$include_phones","location":[518,74,518,97],"scope":"add_clinic_params","value":"false","type":"bool"},{"kind":128,"name":"$include_map","location":[518,99,518,119],"scope":"add_clinic_params","value":"false","type":"bool"}]},{"kind":32,"name":"add_appt_params","modifiers":2,"location":[557,4,571,5],"description":"Adds the appointment information to the template params","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[557,39,557,47],"scope":"add_appt_params","type":"array"}]},{"kind":32,"name":"add_orig_appt_params","modifiers":2,"location":[578,4,589,5],"description":"Adds the datetime information for the appointment that was rescheduled","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[578,44,578,52],"description":"current param data","scope":"add_orig_appt_params","type":"array"}]},{"kind":32,"name":"add_patient_params","modifiers":2,"location":[596,4,617,5],"description":"Appends patient profile data to the template params","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[596,42,596,50],"scope":"add_patient_params","type":"array"}]},{"kind":32,"name":"add_treatment_params","modifiers":2,"location":[625,4,635,5],"description":"Adds the treatment information","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[625,44,625,52],"description":"reference to the current text params","scope":"add_treatment_params","type":"array"},{"kind":128,"name":"$id_language","location":[625,54,625,66],"scope":"add_treatment_params","type":"int"}]},{"kind":32,"name":"add_instance_source","modifiers":2,"location":[644,4,672,5],"description":"Adds the instance from which the appointment was made","scope":"HH\\Mail\\Handler\\Appointment\\Base","children":[{"kind":128,"name":"$params","location":[644,43,644,51],"description":"reference to the current text params","scope":"add_instance_source","type":"array"},{"kind":128,"name":"$id_language","location":[644,53,644,65],"description":"language info","scope":"add_instance_source","type":"int"},{"kind":128,"name":"$include_logo","location":[644,67,644,88],"scope":"add_instance_source","value":"false","type":"mixed"}]},{"kind":32,"name":"get_patient_calendar_link","modifiers":34,"location":[679,4,683,5],"description":"Returns the link to the patient message dashboard","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"string"},{"kind":32,"name":"get_patient_hulivida_link","modifiers":34,"location":[690,4,693,5],"description":"Returns the link to the patient message dashboard","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"string"},{"kind":32,"name":"get_practice_calendar_link","modifiers":34,"location":[700,4,704,5],"description":"Returns the link to the doctor/assistant message dashborad","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"string"},{"kind":32,"name":"get_instance_for_photo","modifiers":4,"location":[712,4,745,5],"description":"Retrieves any instance photo url depending on the appointment details,\nalso returns whether the instance associated enforces a specific photo.","scope":"HH\\Mail\\Handler\\Appointment\\Base","type":"array"}]}]}}