{"uri":"file:///Users/vega/Code/huli/manager-web/src/library/HH/Subscription/Trial.php","root":{"kind":0,"name":"","children":[{"kind":512,"name":"HH\\Subscription","location":[11,0,11,26]},{"kind":1,"name":"DateInterval","modifiers":4096,"location":[13,5,13,17],"associated":[{"kind":1,"name":"DateInterval"}]},{"kind":1,"name":"DateTime","modifiers":4096,"location":[14,5,14,13],"associated":[{"kind":1,"name":"DateTime"}]},{"kind":1,"name":"DateTimeZone","modifiers":4096,"location":[15,5,15,17],"associated":[{"kind":1,"name":"DateTimeZone"}]},{"kind":1,"name":"Exception","modifiers":4096,"location":[16,5,16,14],"associated":[{"kind":1,"name":"Exception"}]},{"kind":1,"name":"TResponse","modifiers":4096,"location":[17,5,17,22],"associated":[{"kind":1,"name":"HH\\Http\\TResponse"}]},{"kind":1,"name":"TrialStatus","modifiers":4096,"location":[18,5,18,48],"associated":[{"kind":1,"name":"HH\\Subscription\\Trial\\Status"}]},{"kind":1,"name":"UserModel","modifiers":4096,"location":[19,5,19,28],"associated":[{"kind":1,"name":"Model\\User"}]},{"kind":1,"name":"HH\\Subscription\\Trial","location":[21,0,470,1],"associated":[{"kind":2,"name":"HH\\Subscription\\ITrial"},{"kind":4,"name":"HH\\Http\\TResponse"}],"description":"_\n_             _ _| |_\n| |           | |_   _|\n| |___  _   _ | | |_|\n| '_  \\| | | || | | |\n| | | || |_| || | | |\n|_| |_|\\___,_||_| |_|\n\n(c) Huli Inc","children":[{"kind":1024,"name":"ERROR_INVALID_TRIAL_DATETIME","modifiers":1,"location":[31,10,31,84],"scope":"HH\\Subscription\\Trial","value":"'Invalid trial datetime \"%s\" (UTC:%s) \"%s\"'"},{"kind":1024,"name":"THRESHOLD_DAYS_BEFORE_ENDING","modifiers":1,"location":[37,10,37,42],"scope":"HH\\Subscription\\Trial","value":"3"},{"kind":1024,"name":"THRESHOLD_ENDS_TODAY","modifiers":1,"location":[38,10,38,34],"scope":"HH\\Subscription\\Trial","value":"0"},{"kind":1024,"name":"THRESHOLD_ENDED_DAYS_CRITICAL","modifiers":1,"location":[39,10,39,43],"scope":"HH\\Subscription\\Trial","value":"3"},{"kind":1024,"name":"THRESHOLD_ENDED_DAYS_TO_CANCEL","modifiers":1,"location":[40,10,40,44],"scope":"HH\\Subscription\\Trial","value":"6"},{"kind":1024,"name":"UTC_FORMAT","modifiers":1,"location":[45,10,45,28],"scope":"HH\\Subscription\\Trial","value":"'UTC'"},{"kind":1024,"name":"MYSQL_DATETIME","modifiers":1,"location":[46,10,46,40],"scope":"HH\\Subscription\\Trial","value":"'Y-m-d H:i:s'"},{"kind":16,"name":"$dt_user","modifiers":4,"location":[53,12,53,20],"scope":"HH\\Subscription\\Trial","type":"DateTime"},{"kind":16,"name":"$dt_utc","modifiers":4,"location":[54,12,54,19],"scope":"HH\\Subscription\\Trial","type":"DateTime"},{"kind":16,"name":"$dt_now_user","modifiers":4,"location":[61,12,61,24],"scope":"HH\\Subscription\\Trial","type":"DateTime"},{"kind":16,"name":"$dt_now_utc","modifiers":4,"location":[62,12,62,23],"scope":"HH\\Subscription\\Trial","type":"DateTime"},{"kind":16,"name":"$grace_hours","modifiers":4,"location":[70,12,70,28],"scope":"HH\\Subscription\\Trial","type":"int"},{"kind":16,"name":"$valid","modifiers":4,"location":[77,12,77,18],"scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":16,"name":"$id_user","modifiers":4,"location":[84,12,84,20],"scope":"HH\\Subscription\\Trial","type":"int"},{"kind":16,"name":"$status","modifiers":4,"location":[91,12,91,19],"scope":"HH\\Subscription\\Trial","type":"HH\\Subscription\\HH\\Subscription\\Trial\\Status"},{"kind":32,"name":"__construct","modifiers":1,"location":[101,4,119,5],"description":"Initialize trial helper","scope":"HH\\Subscription\\Trial","children":[{"kind":128,"name":"$trial_end_on","location":[101,32,101,45],"description":"datetime value to process","scope":"__construct","type":"string"},{"kind":128,"name":"$id_user","location":[101,47,101,62],"description":"(Optional) doctor user id for further validation","scope":"__construct","value":"null","type":"int"},{"kind":128,"name":"$trial_length","location":[101,64,101,84],"description":"(Optional) trial days","scope":"__construct","value":"null","type":"int"},{"kind":128,"name":"$utc","location":[101,86,101,97],"description":"(Optional) is trial end on in utc format","scope":"__construct","value":"true","type":"bool"}]},{"kind":32,"name":"has_trial","modifiers":1,"location":[128,4,131,5],"description":"Verify if current plan has no trial","scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":32,"name":"is_known_trial","modifiers":1,"location":[141,4,145,5],"description":"Checks if trial object has any datetime setup","scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":32,"name":"set_grace_hours","modifiers":1,"location":[153,4,179,5],"description":"Setter for grace hours. Modifies datetime directly\nGrace hours are part of trial period calculations","scope":"HH\\Subscription\\Trial","children":[{"kind":128,"name":"$grace_hours","location":[153,36,153,52],"scope":"set_grace_hours","value":"0","type":"int"}]},{"kind":32,"name":"get_trial_utc","modifiers":1,"location":[186,4,189,5],"description":"Getter for trial end on datetime in UTC format","scope":"HH\\Subscription\\Trial","type":"string|null"},{"kind":32,"name":"get_trial_user_timezone","modifiers":1,"location":[196,4,199,5],"description":"Getter for trial end on datetime in user format","scope":"HH\\Subscription\\Trial","type":"string|null"},{"kind":32,"name":"format_trial_user_timezone","modifiers":1,"location":[208,4,211,5],"description":"Format trial end on datetime in user format","scope":"HH\\Subscription\\Trial","type":"string","children":[{"kind":128,"name":"$format","location":[208,47,208,54],"description":"Date format\n","scope":"format_trial_user_timezone","type":"string"}]},{"kind":32,"name":"get_user_remaining_days","modifiers":1,"location":[218,4,223,5],"description":"Getter for trial remaining days in user datetime","scope":"HH\\Subscription\\Trial","type":"int"},{"kind":32,"name":"get_user_remaining_hours","modifiers":1,"location":[230,4,240,5],"description":"Getter for trial remaining hours in user datetime","scope":"HH\\Subscription\\Trial","type":"float"},{"kind":32,"name":"get_user_past_due_days","modifiers":1,"location":[247,4,252,5],"description":"Getter for trial past due days in user datetime","scope":"HH\\Subscription\\Trial","type":"int"},{"kind":32,"name":"get_status","modifiers":1,"location":[257,4,260,5],"scope":"HH\\Subscription\\Trial","typeSource":1,"type":"int"},{"kind":32,"name":"ends_today","modifiers":1,"location":[267,4,274,5],"description":"Detect if trial ends today","scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":32,"name":"is_active_period","modifiers":1,"location":[281,4,284,5],"description":"Validates if user is in trial period","scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":32,"name":"has_ended","modifiers":1,"location":[292,4,295,5],"description":"Validates if user trial has ended\nInverse mask of is_active_period","scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":32,"name":"is_valid_datetime","modifiers":1,"location":[304,4,309,5],"description":"Verifies if stored datetime is a valid trial end value","scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":32,"name":"is_currently_on_grace_period","modifiers":1,"location":[316,4,323,5],"description":"Checks if current timestamp is in grace hours period (extended trial)","scope":"HH\\Subscription\\Trial","type":"bool"},{"kind":32,"name":"process_trial_end_on","modifiers":4,"location":[331,4,382,5],"description":"Store trial end on in user and UTC timezones","scope":"HH\\Subscription\\Trial","children":[{"kind":128,"name":"$trial_end_on","location":[331,42,331,55],"scope":"process_trial_end_on","type":"mixed"},{"kind":128,"name":"$utc","location":[331,57,331,68],"scope":"process_trial_end_on","value":"true","type":"mixed"}]},{"kind":32,"name":"get_user_remaining","modifiers":4,"location":[394,4,405,5],"description":"Internal getter for trial remaining datetime (diff)\nCalculated over UTC to avoid time conversions","scope":"HH\\Subscription\\Trial","type":"DateInterval"},{"kind":32,"name":"get_user_past_due","modifiers":4,"location":[417,4,428,5],"description":"Internal getter for trial past due datetime (diff)\nCalculated over UTC to avoid time conversions","scope":"HH\\Subscription\\Trial","type":"DateInterval"},{"kind":32,"name":"get_grace_hours_interval","modifiers":4,"location":[435,4,438,5],"description":"Internal getter for grace hours date interval","scope":"HH\\Subscription\\Trial","type":"DateInterval"},{"kind":32,"name":"define_status","modifiers":4,"location":[445,4,469,5],"description":"Define current trial status based on provided parameters","scope":"HH\\Subscription\\Trial","type":"HH\\Subscription\\Trial"}]}]}}